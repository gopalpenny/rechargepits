<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="rechargepits">
<title>recharge-pit-models â€¢ rechargepits</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="recharge-pit-models">
<meta property="og:description" content="rechargepits">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">rechargepits</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/green-ampt-derivations.html">green-ampt-derivations</a>
    <a class="dropdown-item" href="../articles/recharge-pit-models.html">recharge-pit-models</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>recharge-pit-models</h1>
            
      
      
      <div class="d-none name"><code>recharge-pit-models.Rmd</code></div>
    </div>

    
    
<p>This package provides an analytical method to estimate the recharge
from subsurface pits. Method provide idealized geometries of the pit
and/or the recharge behavior in order to make the mathematics more
tractable. The basic assumptions about flow within each of the models
are those assumptions made by the Green-Ampt method:</p>
<ol style="list-style-type: decimal">
<li>Homogeneous soil with initial water content (theta_0)</li>
<li>Constant pressure head (h_0) at the wetting front</li>
<li>Saturated soil above above wetting front</li>
<li>Continuous supply of water with constant head (h_b) at the soil
surface boundary</li>
</ol>
<p>With respect to the pits, further assumptions are made as described
below.</p>
<div class="section level2">
<h2 id="rectangular-pit-with-perpendicular-flow">Rectangular pit with perpendicular flow<a class="anchor" aria-label="anchor" href="#rectangular-pit-with-perpendicular-flow"></a>
</h2>
<p>In this case, the pit is represented as a rectangular volume with a
length, width, and depth. All flow occurs perpendicular to the pit.
Therefore the calculated recharge underestimates the actual recharge
because this approach fails to account for (e.g.) diagonal flow away
from the corners of the pit, which may represent considerable flow</p>
<p>In order to set up the model, the dimensions of the pit must be set
as <code>units</code> objects. For example:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-quantities.github.io/units/" class="external-link">units</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## udunits database from /Library/Frameworks/R.framework/Versions/4.3-arm64/Resources/library/units/share/udunits/udunits2.xml</span></span></code></pre>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">length</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-quantities.github.io/units/reference/units.html" class="external-link">set_units</a></span><span class="op">(</span><span class="fl">4</span>, <span class="st">"ft"</span><span class="op">)</span></span>
<span><span class="va">width</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-quantities.github.io/units/reference/units.html" class="external-link">set_units</a></span><span class="op">(</span><span class="fl">4</span>, <span class="st">"ft"</span><span class="op">)</span></span>
<span><span class="va">height</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-quantities.github.io/units/reference/units.html" class="external-link">set_units</a></span><span class="op">(</span><span class="fl">6</span>, <span class="st">"ft"</span><span class="op">)</span></span></code></pre></div>
<p>Additionally, initial water content (<code>theta_0</code>), porosity
(<code>theta_s</code>), saturated hydraulic conductivity
(<code>Ksat</code>), and the time(s) at which the infiltration should be
estimated (<code>times</code>).</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">theta_0</span> <span class="op">&lt;-</span> <span class="fl">0.2</span> <span class="co"># unitless</span></span>
<span><span class="va">theta_s</span> <span class="op">&lt;-</span> <span class="fl">0.35</span> <span class="co"># unitless</span></span>
<span><span class="va">Ksat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-quantities.github.io/units/reference/units.html" class="external-link">set_units</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="st">"cm/h"</span><span class="op">)</span> <span class="co"># length / time</span></span>
<span><span class="va">h_0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-quantities.github.io/units/reference/units.html" class="external-link">set_units</a></span><span class="op">(</span><span class="op">-</span><span class="fl">10</span>, <span class="st">"cm"</span><span class="op">)</span> <span class="co"># hydraulic head (length)</span></span>
<span><span class="va">times</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-quantities.github.io/units/reference/units.html" class="external-link">set_units</a></span><span class="op">(</span><span class="fl">1</span>,<span class="st">"hr"</span><span class="op">)</span></span></code></pre></div>
<p>These values are then provides to the function
<code>get_pit_recharge_rectangular</code> as:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">rechargepits</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/get_pit_recharge_rectangular.html">get_pit_recharge_rectangular</a></span><span class="op">(</span><span class="va">height</span>, <span class="va">length</span>, <span class="va">width</span>, <span class="va">theta_s</span>, <span class="va">Ksat</span>, <span class="va">theta_0</span>, <span class="va">h_0</span>, <span class="va">times</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## 9.301142 [ft^3]</span></span></code></pre>
<p>Note that this function assumes the pit is filled with water
beginning at t = 0, and that infiltration does not lead to a reduction
in water in the pit over time (i.e., constant head profile within the
pit throughout the infiltration event).</p>
<p>Also note that this approach is equivalent to using the built-in
functions to estimate pit recharge across vertical transects of the
walls (<code>get_greenampt_horiz_flow_integrated</code>) and point
recharge downward from the bottom of the pit
(<code>get_greenampt_flow_numerical</code>). Multiplying these values to
convert to volumes of recharge gives the final result.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">h_b</span> <span class="op">&lt;-</span> <span class="va">height</span></span>
<span></span>
<span><span class="co"># get horizontal flow:</span></span>
<span><span class="va">Fv</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_greenampt_horiz_flow_integrated.html">get_greenampt_horiz_flow_integrated</a></span><span class="op">(</span><span class="va">theta_0</span>, <span class="va">theta_s</span>, <span class="va">Ksat</span>, <span class="va">h_b</span>, <span class="va">h_0</span>, times <span class="op">=</span> <span class="va">times</span><span class="op">)</span></span>
<span><span class="va">flow_horizontal</span> <span class="op">&lt;-</span> <span class="va">Fv</span> <span class="op">*</span> <span class="op">(</span><span class="va">width</span> <span class="op">*</span> <span class="fl">2</span> <span class="op">+</span> <span class="va">length</span> <span class="op">*</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fcum_vert</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_greenampt_flow_numerical.html">get_greenampt_flow_numerical</a></span><span class="op">(</span><span class="va">theta_0</span>, <span class="va">theta_s</span>, <span class="va">Ksat</span>, <span class="va">h_b</span>, <span class="va">h_0</span>, <span class="va">times</span><span class="op">)</span></span>
<span><span class="va">flow_vertical</span> <span class="op">&lt;-</span> <span class="va">fcum_vert</span> <span class="op">*</span> <span class="va">width</span> <span class="op">*</span> <span class="va">length</span></span>
<span><span class="va">flow_vertical</span> <span class="op">&lt;-</span> <span class="fu">units</span><span class="fu">::</span><span class="fu"><a href="https://r-quantities.github.io/units/reference/units.html" class="external-link">set_units</a></span><span class="op">(</span><span class="va">flow_vertical</span>, <span class="fu"><a href="https://rdrr.io/r/base/units.html" class="external-link">units</a></span><span class="op">(</span><span class="va">flow_horizontal</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">flow</span> <span class="op">&lt;-</span> <span class="va">flow_horizontal</span> <span class="op">+</span> <span class="va">flow_vertical</span></span>
<span><span class="va">flow</span></span></code></pre></div>
<pre><code><span><span class="co">## 9.301142 [ft^3]</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="cylindrical-pit-with-half-spherical-bottom-flow">Cylindrical pit with half-spherical bottom flow<a class="anchor" aria-label="anchor" href="#cylindrical-pit-with-half-spherical-bottom-flow"></a>
</h2>
<p>Here the pit is represented by a radius and a depth. Water flows
radially outwards creating an expanding cylinder along the depth of the
pit. At the bottom of the pit, water flows radially outward to create a
downward half-sphere. Gravity (i.e., the elevation gradient) is fully
ignored to make the math tractable. This may be a reasonable assumption
if the pit is deep enough that the pressure head gradient is much
greater than 1.</p>
<!-- We first model a simple cylindrical pit, 6 ft deep with a 2 ft radius in a homogeneous soil profile. This can be done simply as: -->
<p><img src="cylindrical-pit-spherical-bottom.jpg" width="250 px"></p>
<div class="section level3">
<h3 id="model-with-two-soil-layers">Model with two soil layers<a class="anchor" aria-label="anchor" href="#model-with-two-soil-layers"></a>
</h3>
<p>Note that different soil layers can be modeled provided no flowlines
intersect any soil boundary. In other words, it is possible to model
multiple soil layers above the bottom of the pit as all flow in this
region is horizontal. However, a confining layer below the bottom of the
pit could not be modeled. Here, we model a recharge pit that is 6 ft
deep with a 2 ft radius. The pit is dug in a 2-layer soil profile with a
low-conductivity (Clay) surface layer of 2 ft underlain by a
high-conductivity layer (Sand) that extends below the bottom of the
pit.</p>
<p>We get the values for <span class="math inline">\(K_{sat}\)</span>
for each from <code>rawls_soils</code>:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="va">rawls_soils</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">texture_class</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Sand"</span>,<span class="st">"Clay"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">texture_class</span>, <span class="va">Ksat_cm_per_h</span>, <span class="va">porosity_effective</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 2 Ã— 3</span></span></span>
<span><span class="co">##   texture_class Ksat_cm_per_h porosity_effective</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                 <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> Sand                  21                 0.417</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> Clay                   0.06              0.385</span></span></code></pre>
<p>We then use <code>get_greenampt_cyl_flow_integrated</code> to model
horizontal cylindrical flow through each layer, and
<code>get_greenampt_hsphere_numerical</code> to obtain flow out the
bottom.</p>
<p>For the clay top layer, we use a bottom pressure head of 2 ft (<span class="math inline">\(h_b = 2 ft\)</span>), a depth of 2 ft (<span class="math inline">\(d = 2 ft\)</span>), a radius of 2 ft (<span class="math inline">\(r_b = 2 ft\)</span>) and a hydraulic conductivity
of clay (<span class="math inline">\(K_{sat} = 0.06 cm/h\)</span>). We
assume a porosity of 0.4, initial volumetric water content of 0.2. And
finally, we discretize the layer into 2 sections such that the radial
outward flow is calculated in 1 foot increments (2 ft depth / 2 sections
= 1 ft/section). We assume a small negative pressure head in the
soil.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">times</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-quantities.github.io/units/reference/units.html" class="external-link">set_units</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span>,<span class="fl">5</span><span class="op">)</span>, <span class="st">"hr"</span><span class="op">)</span> <span class="co"># units of length^2</span></span>
<span><span class="va">Fcum_clay_horiz</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_greenampt_cyl_flow_integrated.html">get_greenampt_cyl_flow_integrated</a></span><span class="op">(</span>theta_0 <span class="op">=</span> <span class="fl">0.2</span>, <span class="co"># unitless</span></span>
<span>                                                     theta_s <span class="op">=</span> <span class="fl">0.4</span>, </span>
<span>                                                     Ksat <span class="op">=</span> <span class="fu"><a href="https://r-quantities.github.io/units/reference/units.html" class="external-link">set_units</a></span><span class="op">(</span><span class="fl">0.06</span>, <span class="st">"cm/h"</span><span class="op">)</span>, </span>
<span>                                                     h_b <span class="op">=</span> <span class="fu"><a href="https://r-quantities.github.io/units/reference/units.html" class="external-link">set_units</a></span><span class="op">(</span><span class="fl">2</span>, <span class="st">"ft"</span><span class="op">)</span>, </span>
<span>                                                     h_0 <span class="op">=</span> <span class="fu"><a href="https://r-quantities.github.io/units/reference/units.html" class="external-link">set_units</a></span><span class="op">(</span><span class="op">-</span><span class="fl">10</span>, <span class="st">"cm"</span><span class="op">)</span>, </span>
<span>                                                     r_b <span class="op">=</span> <span class="fu"><a href="https://r-quantities.github.io/units/reference/units.html" class="external-link">set_units</a></span><span class="op">(</span><span class="fl">2</span>, <span class="st">"ft"</span><span class="op">)</span>, </span>
<span>                                                     times <span class="op">=</span> <span class="va">times</span>,</span>
<span>                                                     F_units <span class="op">=</span> <span class="st">"ft^3"</span>, </span>
<span>                                                     num_sections <span class="op">=</span> <span class="fl">2</span>, </span>
<span>                                                     d <span class="op">=</span> <span class="fu"><a href="https://r-quantities.github.io/units/reference/units.html" class="external-link">set_units</a></span><span class="op">(</span><span class="fl">2</span>, <span class="st">"ft"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>For the sand layer, we use a bottom pressure head of 6 ft (<span class="math inline">\(h_b = 6 ft\)</span>), a depth of 4 ft (<span class="math inline">\(d = 4 ft\)</span>), a radius of 2 ft (<span class="math inline">\(r_b = 2 ft\)</span>) and a hydraulic conductivity
of sand (<span class="math inline">\(K_{sat} = 21 cm/h\)</span>). We
keep the same porosity and initial VWC, and again use 1 foot discrete
sections (i.e., 4 sections).</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Fcum_sand_horiz</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_greenampt_cyl_flow_integrated.html">get_greenampt_cyl_flow_integrated</a></span><span class="op">(</span>theta_0 <span class="op">=</span> <span class="fl">0.2</span>, <span class="co"># unitless</span></span>
<span>                                                     theta_s <span class="op">=</span> <span class="fl">0.4</span>, </span>
<span>                                                     Ksat <span class="op">=</span> <span class="fu"><a href="https://r-quantities.github.io/units/reference/units.html" class="external-link">set_units</a></span><span class="op">(</span><span class="fl">23</span>, <span class="st">"cm/h"</span><span class="op">)</span>, </span>
<span>                                                     h_b <span class="op">=</span> <span class="fu"><a href="https://r-quantities.github.io/units/reference/units.html" class="external-link">set_units</a></span><span class="op">(</span><span class="fl">6</span>, <span class="st">"ft"</span><span class="op">)</span>, </span>
<span>                                                     h_0 <span class="op">=</span> <span class="fu"><a href="https://r-quantities.github.io/units/reference/units.html" class="external-link">set_units</a></span><span class="op">(</span><span class="op">-</span><span class="fl">10</span>, <span class="st">"cm"</span><span class="op">)</span>, </span>
<span>                                                     r_b <span class="op">=</span> <span class="fu"><a href="https://r-quantities.github.io/units/reference/units.html" class="external-link">set_units</a></span><span class="op">(</span><span class="fl">2</span>, <span class="st">"ft"</span><span class="op">)</span>, </span>
<span>                                                     times <span class="op">=</span> <span class="va">times</span>,</span>
<span>                                                     F_units <span class="op">=</span> <span class="st">"ft^3"</span>, </span>
<span>                                                     num_sections <span class="op">=</span> <span class="fl">4</span>, </span>
<span>                                                     d <span class="op">=</span> <span class="fu"><a href="https://r-quantities.github.io/units/reference/units.html" class="external-link">set_units</a></span><span class="op">(</span><span class="fl">4</span>, <span class="st">"ft"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Next, we get the flow from the bottom. This requires the same inputs
for the sand layer at a depth of 6 ft.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Fcum_sand_bottom</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_greenampt_hsphere_numerical.html">get_greenampt_hsphere_numerical</a></span><span class="op">(</span>theta_0 <span class="op">=</span> <span class="fl">0.2</span>, <span class="co"># unitless</span></span>
<span>                                                    theta_s <span class="op">=</span> <span class="fl">0.4</span>, </span>
<span>                                                    Ksat <span class="op">=</span> <span class="fu"><a href="https://r-quantities.github.io/units/reference/units.html" class="external-link">set_units</a></span><span class="op">(</span><span class="fl">23</span>, <span class="st">"cm/h"</span><span class="op">)</span>, </span>
<span>                                                    h_b <span class="op">=</span> <span class="fu"><a href="https://r-quantities.github.io/units/reference/units.html" class="external-link">set_units</a></span><span class="op">(</span><span class="fl">6</span>, <span class="st">"ft"</span><span class="op">)</span>, </span>
<span>                                                    h_0 <span class="op">=</span> <span class="fu"><a href="https://r-quantities.github.io/units/reference/units.html" class="external-link">set_units</a></span><span class="op">(</span><span class="op">-</span><span class="fl">10</span>, <span class="st">"cm"</span><span class="op">)</span>, </span>
<span>                                                    r_b <span class="op">=</span> <span class="fu"><a href="https://r-quantities.github.io/units/reference/units.html" class="external-link">set_units</a></span><span class="op">(</span><span class="fl">2</span>, <span class="st">"ft"</span><span class="op">)</span>, </span>
<span>                                                    times <span class="op">=</span> <span class="va">times</span>,</span>
<span>                                                    F_units <span class="op">=</span> <span class="st">"ft^3"</span><span class="op">)</span></span></code></pre></div>
<p>Finally, we obtain the total recharge as a sum of the above three
outputs:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="va">Fcum</span> <span class="op">&lt;-</span> <span class="va">Fcum_clay_horiz</span> <span class="op">+</span> <span class="va">Fcum_sand_horiz</span> <span class="op">+</span> <span class="va">Fcum_sand_bottom</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">times</span>, <span class="va">Fcum</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="recharge-pit-models_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
<p>We can view the contribution from each of the models by combining the
data into a <code>data.frame</code> and plotting:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_cols.html" class="external-link">bind_cols</a></span><span class="op">(</span>times_h <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">times</span>, <span class="fl">3</span><span class="op">)</span>, </span>
<span>                          recharge_cu_ft <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">Fcum_clay_horiz</span>,<span class="va">Fcum_sand_horiz</span>, <span class="va">Fcum_sand_bottom</span><span class="op">)</span>, </span>
<span>                          layer <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Clay horiz"</span>, <span class="st">"Sand horiz"</span>, <span class="st">"Sand bottom"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">times</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">layer</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">layer</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Clay horiz"</span>, <span class="st">"Sand horiz"</span>, <span class="st">"Sand bottom"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">times_h</span><span class="op">)</span>, <span class="va">recharge_cu_ft</span>, fill <span class="op">=</span> <span class="va">layer</span><span class="op">)</span>, stat <span class="op">=</span> <span class="st">'identity'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Time [h]"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Cumulative recharge"</span><span class="op">)</span></span></code></pre></div>
<p><img src="recharge-pit-models_files/figure-html/unnamed-chunk-12-1.png" width="700"></p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by The package maintainer.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
