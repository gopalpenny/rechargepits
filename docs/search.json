[{"path":"/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2023 Gopal Penny Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"/articles/green-ampt-derivations.html","id":"green-ampt-derivations","dir":"Articles","previous_headings":"","what":"Green-ampt derivations","title":"green-ampt-derivations","text":"packages provides analytical root-finding methods calculating groundwater recharge specific geometries. case, models follow assumptions used Green-Ampt method: Homogeneous soil initial water content (theta_0) Constant pressure head (h_0) wetting front Saturated soil wetting front Continuous supply water constant head (h_b) soil surface boundary building blocks pit recharge calculations analytical equations simulating specific infiltration scenarios described .","code":""},{"path":"/articles/green-ampt-derivations.html","id":"vertical-flow-green-ampt-equation","dir":"Articles","previous_headings":"Green-ampt derivations","what":"Vertical flow: Green-Ampt equation","title":"green-ampt-derivations","text":"derive Green-Ampt equation, need combine following equations. First, Darcy flow: \\[ q = -K_{sat} \\frac{\\partial h}{\\partial z} \\] \\(q\\) downward Darcy point flow, \\(h\\) hydraulic head sum pressure elevation head, \\(K_{sat}\\) saturated hydraulic conductivity, \\(z\\) elevation (positive downward). Note total head bottom pit (\\(z=0\\)) \\(h_b\\) wetting front (\\(z=z_f\\)) \\(h_0 - z_f\\). Due linear relationship \\(h\\) \\(z\\), integrating equation allows us calculate \\(q\\) : \\[ q = K_{sat} \\frac{h_b - (h_0 - z_f)}{z_f} \\] also know downward propagation wetting front occurs rate \\[\\frac{\\partial z_f}{\\partial t} = \\frac{q}{\\Delta \\theta},\\] \\(\\Delta \\theta = \\theta_s - \\theta_0\\). know cumulative infiltration \\(F = z_f \\Delta \\theta\\), combining equations substitution yields: \\[ \\frac{F}{\\Delta \\theta} \\frac{\\partial F}{\\partial t} = K_{sat} (h_b + F/\\Delta \\theta - h_0) \\] Integration equation yields Green-Ampt equation, time \\(t\\) function cumulative 1-D infiltration \\(F\\): \\[ t = \\frac{1}{K_{sat}}\\Big[F - \\Delta \\theta (h_b - h_0) \\ln (1 + \\frac{F}{\\Delta \\theta (h_b - h_0)}) \\Big] \\] Green-Ampt equation implemented package function get_greenampt_time implements analytical version, well function get_greenampt_flow_numerical uses root solver find cumulative infiltration function time. Note package functions expects units objects appropriate ensure proper arithmetic dimensional variables. , numerical approximation calculates \\(F\\) \\(t \\[0, 2, 5, 10, 20, 40, 60]\\) minutes. Note returned vector units object, case units mm. can make sure two functions produce results using analytical version convert back time follows, plot results.","code":"# prep soil variables library(rechargepits) library(units) #> udunits database from /Library/Frameworks/R.framework/Versions/4.3-arm64/Resources/library/units/share/udunits/udunits2.xml theta_0 <- 0.2 # unitless theta_s <- 0.35 # unitless Ksat <- set_units(0.2, \"cm/h\") # length / time h_b <- set_units(6, \"ft\") # hydraulic head (length) h_0 <- set_units(-10, \"cm\") # hydraulic head (length) times <- set_units(c(0, 2, 5, 10, 20, 40, 60), \"min\")  # Calculate cumulative infiltration as a function of time Fcum <- get_greenampt_flow_numerical(theta_0, theta_s, Ksat, h_b, h_0, times) Fcum #> Units: [mm] #> [1]  0.000000  6.255460  9.931811 14.111226 20.087695 28.672159 35.365012 # Calculate time as a function of Fcum  time_calc <- set_units(get_greenampt_time(theta_0, theta_s, Fcum, Ksat, h_b, h_0),\"min\")  df <- data.frame(time = c(times, time_calc),                  Fcum = rep(Fcum, 2),                  group = rep(c(\"Fcum = f(t)\", \"t = f(Fcum)\"), each = length(Fcum))) library(ggplot2) ggplot(df) +    geom_point(aes(time, Fcum, color = group, shape = group), size = 3, stroke = 1) +   scale_shape_manual(values = c(1, 3))"},{"path":[]},{"path":"/articles/green-ampt-derivations.html","id":"horizontal-parallel-flow","dir":"Articles","previous_headings":"Green-ampt derivations > Horizontal flow: Green-Ampt without gravity","what":"Horizontal parallel flow","title":"green-ampt-derivations","text":"scenario similar Green-Ampt except flow occurs horizontally vertical surface. Darcy flow case can calculated : \\[ q = K_{sat} \\frac{h_b - h_0}{x_f}, \\] new variable \\(x_f\\), horizontal distance soil boundary wetting front. Note cumulative infiltration \\(F = x_f \\Delta \\theta\\). Also note \\(x_f\\) present numerator. equation becomes: \\[ \\frac{F}{\\Delta \\theta} \\frac{\\partial F}{\\partial t} = K_{sat} (h_b - h_0). \\] integrated, get two versions final equations, one solved \\(t\\): \\[ t = \\frac{F^2}{2 \\Delta \\theta K_{sat} (h_b - h_0)} \\] \\(F\\): \\[ F = \\sqrt{2 \\Delta \\theta K_{sat} (h_b - h_0) t}, \\] Using soil properties , can calculate infiltration using get_greenampt_horiz_flow get_greenampt_horiz_time:","code":"# Calculate cumulative infiltration as a function of time Fcum_horiz <- get_greenampt_horiz_flow(theta_0, theta_s, Ksat, h_b, h_0, times) Fcum_horiz #> Units: [cm] #> [1] 0.0000000 0.6210958 0.9820387 1.3888124 1.9640774 2.7776249 3.4018818 time_calc <- set_units(get_greenampt_horiz_time(theta_0, theta_s, Fcum_horiz, Ksat, h_b, h_0),\"min\")  df <- data.frame(time = c(times, time_calc),                  Fcum = rep(Fcum, 2),                  group = rep(c(\"Fcum = f(t)\", \"t = f(Fcum)\"), each = length(Fcum))) library(ggplot2) ggplot(df) +    geom_point(aes(time, Fcum, color = group, shape = group), size = 3, stroke = 1) +   scale_shape_manual(values = c(1, 3))"},{"path":"/articles/green-ampt-derivations.html","id":"horizontal-parallel-flow-integrated-over-a-depth","dir":"Articles","previous_headings":"Green-ampt derivations > Horizontal flow: Green-Ampt without gravity","what":"Horizontal parallel flow integrated over a depth","title":"green-ampt-derivations","text":"Now ’d like single equation calculate horizontal infiltration vertical surface, refer \\(F_v\\), noting \\(\\Delta F_v = F \\Delta z\\). Therefore need integrate, noting now use \\(h_p(z)\\) indicate pressure head pit: \\[ F_v = \\int F \\partial z = \\sqrt{2 \\Delta \\theta K_{sat} t} \\int_{z_1}^{z_1 + d} (h_p(z) - h_0)^{1/2} \\partial z \\] \\(d\\) depth profile integrate (e.g., bottom pit). define \\(z\\) positive downward direction \\(h_p = z\\). define \\(h_b\\) pressure head bottom profile, entails \\(z_2 = h_b\\) \\(z_1 = h_b - d\\) top pit. integration becomes: \\[ F_v = \\sqrt{2 \\Delta \\theta K_{sat} t} \\int_{h_b - d}^{h_b} (z - h_0)^{1/2} \\partial z \\] Integrating right side end : \\[ F_v = \\sqrt{\\frac{8}{9} \\Delta \\theta K_{sat} t} \\Big[(h_b - h_0)^{3/2} - (h_b - d - h_0)^{3/2} \\Big] \\] equation implemented get_greenampt_horiz_flow_integrated. demonstrate works, can compare point flow integrated flow differential depth (e.g., 1 mm): percent error -0.013%. final example shows shape wetting front along profile curved.","code":"library(units) theta_0 <- 0.2 # unitless theta_s <- 0.35 # unitless Ksat <- set_units(0.2, \"cm/h\") # length / time h_b <- set_units(6, \"ft\") # hydraulic head (length) h_0 <- set_units(-10, \"cm\") # hydraulic head (length)  Fv <- get_greenampt_horiz_flow_integrated(theta_0, theta_s, Ksat, h_b, h_0, times = set_units(1,\"hr\"), d = NULL) # Get the infiltration over a 1 mm differential depth to compare with the point infiltration Fv_dv <- get_greenampt_horiz_flow_integrated(theta_0, theta_s, Ksat, h_b, h_0, times = set_units(1,\"hr\"), d = set_units(1, \"mm\")) Fv_point <- Fv_dv/ set_units(1, \"mm\") Fv_point #> 34.01441 [mm]  # Get the point infiltration F_point <- get_greenampt_horiz_flow(theta_0, theta_s, Ksat, h_b, h_0, times = set_units(1,\"hr\"))  F_point <- set_units(F_point, \"mm\") F_point #> 34.01882 [mm] # percent error: (Fv_point - F_point) / F_point * 100 VWC_0 <- 0.2 # unitless n <- 0.35 # unitless Ksat <- set_units(0.2, \"cm/h\") # length / time h_b <- set_units(seq(0,6), \"ft\") # hydraulic head (length) h_0 <- set_units(-10, \"cm\") # hydraulic head (length) times <- set_units(c(60), \"min\")  # Calculate cumulative infiltration as a function of time  for (i in 1:length(h_b)) {   h_b_z <- h_b[i]   if (i == 0) {     Fcum[i] <- get_greenampt_flow_numerical(VWC_0, n, Ksat, h_b_z, h_0, times)   } else {     Fcum[i] <- get_greenampt_flow_numerical(VWC_0, n, Ksat, h_b_z, h_0, times)     } }  plot(Fcum, -h_b)"},{"path":"/articles/green-ampt-derivations.html","id":"horizontal-flow-through-a-cylinder","dir":"Articles","previous_headings":"Green-ampt derivations > Horizontal flow: Green-Ampt without gravity","what":"Horizontal flow through a cylinder","title":"green-ampt-derivations","text":"now focus horizontal flow (.e., gravity effect) radially outward cylinder. case goal calculate radius wetting front (\\(r_f\\)), cumulative infiltration can calculated time \\(t\\) \\(F_c = \\pi (r_f^2 - r_b^2) \\Delta \\theta\\), \\(r_b\\) boundary recharge pit. note \\(Q = 2 \\pi r q(r)\\) therefore \\(q = \\frac{Q}{2 \\pi r}\\). \\(q\\) Darcy flow, can plug Darcy’s law obtain: \\[ \\frac{Q}{2 \\pi r} = -K_{sat} \\frac{\\partial h}{\\partial r} \\] Integrating equation \\((r_b, h_b)\\) \\((r_f, h_0)\\), get: \\[ Q = 2 \\pi K_{sat} (h_b - h_0) \\frac{1}{\\ln (r_f / r_b)} \\] note propagation wetting front outward directly related \\(Q\\) \\(\\frac{\\partial r_f}{\\partial t} = \\frac{Q}{2 \\pi r_f \\Delta \\theta}\\). Plugging equation \\(Q\\) rearranging, obtain: \\[ r_f \\ln(r_f / r_b) \\partial r_f = \\frac{1}{\\Delta \\theta }(h_b - h_0) \\partial t \\] Integrating two sides \\((t = 0, r = r_b)\\) \\((t, r_f)\\), obtain (via wolfram alpha): \\[ \\frac{1}{4} (r_b^2 + 2 r_f^2 \\ln \\frac{r_f}{r_b} - r_f^2) = t\\frac{h_b - h_0}{\\Delta \\theta } \\] Finally, solving \\(t\\), obtain: \\[ t = \\frac{\\Delta \\theta}{4 (h_b - h_0)} (r_b^2 + 2 r_f^2 \\ln \\frac{r_f}{r_b} - r_f^2) \\] \\[ t = \\frac{\\Delta \\theta}{4 (h_b - h_0)} \\Big[r_b^2 + r_f^2 (2  \\ln \\frac{r_f}{r_b} - 1) \\Big] \\] noted , straightforward convert \\(F_c\\) \\(r_f\\). Rearranging prior equation, : \\[ r_f = \\sqrt{ \\frac{F_c}{\\pi \\Delta \\theta} + r_b^2} \\] model implemented using functions get_greenampt_cyl_horiz_time calculate time \\(t = f(F_c)\\) get_greenampt_cyl_horiz_numerical calculate cumulative recharge \\(F_c = f(t)\\) using numerical solver.","code":"library(units) r_b <- set_units(2, \"ft\") # length theta_0 <- 0.2 # unitless theta_s <- 0.35 # unitless F_c <- set_units(c(1, 5, 10, 20), \"ft^2\") # units of length^2 Ksat <- set_units(0.2, \"cm/h\") # length / time h_b <- set_units(6, \"ft\") # hydraulic head (length) h_0 <- set_units(-10, \"cm\") # hydraulic head (length) times <- get_greenampt_cyl_horiz_time(theta_0, theta_s, F_c, Ksat, h_b, h_0, r_b) F_c_calculated <- get_greenampt_cyl_horiz_numerical(theta_0, theta_s, Ksat, h_b, h_0, r_b, times, F_units = \"ft^2\")   plot(times, F_c, cex = 2, col = 'blue') points(times, F_c_calculated, pch = 4, col = 'red', cex = 1) legend(6, 7, legend = c(\"get_greenampt_hsphere_time\", \"get_greenampt_hsphere_numerical\"),         col = c(\"blue\", \"red\"), cex = 0.8, pch = c(1, 4))"},{"path":"/articles/green-ampt-derivations.html","id":"half-spherical-flow-without-gravity","dir":"Articles","previous_headings":"Green-ampt derivations","what":"Half-spherical flow without gravity","title":"green-ampt-derivations","text":"case consider flow half spherical surface considering pressure potentials ignoring gravity. model potentially approximate 3-D infiltration bottom recharge pit pressure head bottom pit large enough gravity term small. approach derivation similar cylindrical flow, first need understand hydraulic gradient function \\(r_f\\), radius wetting front. surface area flow passes \\(2 \\pi r^2\\), half surface area sphere (\\(4 \\pi r^2\\)). pressure matters flow throughout half-sphere, can write Darcy’s law : \\[ \\frac{Q}{2 \\pi r^2} = -K_{sat} \\frac{\\partial h}{\\partial r}. \\] approximate bottom pit half sphere radius \\(r_b\\), effective radius pit. Although simplification reality, makes scenario mathematically tractable. integrate equation idealized pit boundary \\((r_b, h_b)\\) wetting front \\((r_f, h_0)\\) obtain: \\[ \\frac{Q}{2 \\pi}\\Big(\\frac{1}{r_b} - \\frac{1}{r_f}\\Big) = K_{sat} (h_b - h_0) \\] Solving \\(Q\\), obtain: \\[ Q = 2 \\pi K_{sat} \\Big(\\frac{r_b r_f}{r_f - r_b} \\Big) (h_b - h_0) \\] Now \\(Q\\) function \\(r_f\\), can focus determining \\(r_f\\) changes time. propagation \\(r_f\\) simply total outward flow \\(Q\\) divided surface area half sphere \\(2 \\pi r^2\\), divided available soil storage \\(\\Delta \\theta = \\theta_s - \\theta_0\\). words: \\[ \\frac{\\partial r_f}{\\partial t} = \\frac{Q}{2 \\pi r^2 \\Delta \\theta} \\, . \\] Plugging \\(Q\\) rearranging terms, get: \\[ \\frac{1}{r_b} \\Big[ r_f^2 - r_b r_f \\Big] \\partial r_f = \\frac{K_{sat}}{\\Delta \\theta} \\Big[ h_b - h_0 \\Big] \\partial t \\,. \\] can integrate \\((r_b, 0)\\) \\((r_f, t)\\) obtain: \\[ \\frac{1}{r_b} \\Big( \\frac{1}{3} r_f^3 - \\frac{r_b}{2} r_f^2 \\Big) \\Bigg|_{r_b}^{r_f} = \\frac{K_{sat}}{\\Delta \\theta} \\Big( h_b - h_0 \\Big) t \\, \\Bigg|_0^t \\] Plugging values solving \\(t\\), finally obtain: \\[ t = \\frac{\\Delta \\theta}{K_{sat} (h_b - h_0)}  \\Bigg[ \\frac{r_f^3}{3 r_b}  - \\frac{r_f^2}{2} + \\frac{r_b^2}{6} \\Bigg] \\] volume half sphere equal \\(V_s(r) = 2/3 \\pi r^3\\). Therefore can determine amount infiltration \\(F_s = \\Delta \\theta (V_s(r_f) - V_s(r_b))\\), : \\[ F_s = \\Delta \\theta \\pi \\frac{2}{3}\\Big( r_f^3 - r_b^3 \\Big) \\] Conversely, can calculate \\(r_f\\) \\(F_s\\) : \\[ r_f = \\Big( \\frac{3 F_s}{2 \\Delta \\theta \\pi} + r_b^3 \\Big)^{1/3} \\] model implemented using functions get_greenampt_hsphere_time calculate time \\(t = f(F_s)\\) get_greenampt_hsphere_numerical calculate cumulative recharge \\(F_s = f(t)\\) using numerical solver.","code":"library(units) r_b <- set_units(2, \"ft\") # length theta_0 <- 0.2 # unitless theta_s <- 0.35 # unitless F_s <- set_units(c(1, 5, 10, 20), \"ft^3\") # units of length^2 Ksat <- set_units(0.2, \"cm/h\") # length / time h_b <- set_units(6, \"ft\") # hydraulic head (length) h_0 <- set_units(-10, \"cm\") # hydraulic head (length) times <- get_greenampt_hsphere_time(theta_0, theta_s, F_s, Ksat, h_b, h_0, r_b) F_s_calculated <- get_greenampt_hsphere_numerical(theta_0, theta_s, Ksat, h_b, h_0, r_b, times)  plot(times, F_s, cex = 2, col = 'blue') points(times, F_s_calculated, pch = 4, col = 'red', cex = 1) legend(6, 7, legend = c(\"get_greenampt_hsphere_time\", \"get_greenampt_hsphere_numerical\"),         col = c(\"blue\", \"red\"), cex = 0.8, pch = c(1, 4))"},{"path":"/articles/recharge-pit-models.html","id":"rectangular-pit-with-perpendicular-flow","dir":"Articles","previous_headings":"","what":"Rectangular pit with perpendicular flow","title":"recharge-pit-models","text":"case, pit represented rectangular volume length, width, depth. flow occurs perpendicular pit. Therefore calculated recharge underestimates actual recharge approach fails account (e.g.) diagonal flow away corners pit, may represent considerable flow order set model, dimensions pit must set units objects. example: Additionally, initial water content (theta_0), porosity (theta_s), saturated hydraulic conductivity (Ksat), time(s) infiltration estimated (times). values provides function get_pit_recharge_rectangular : Note function assumes pit filled water beginning t = 0, infiltration lead reduction water pit time (.e., constant head profile within pit throughout infiltration event). Also note approach equivalent using built-functions estimate pit recharge across vertical transects walls (get_greenampt_horiz_flow_integrated) point recharge downward bottom pit (get_greenampt_flow_numerical). Multiplying values convert volumes recharge gives final result.","code":"library(units) ## udunits database from /Library/Frameworks/R.framework/Versions/4.3-arm64/Resources/library/units/share/udunits/udunits2.xml length <- set_units(4, \"ft\") width <- set_units(4, \"ft\") height <- set_units(6, \"ft\") theta_0 <- 0.2 # unitless theta_s <- 0.35 # unitless Ksat <- set_units(0.2, \"cm/h\") # length / time h_0 <- set_units(-10, \"cm\") # hydraulic head (length) times <- set_units(1,\"hr\") library(rechargepits) get_pit_recharge_rectangular(height, length, width, theta_s, Ksat, theta_0, h_0, times) ## 9.301142 [ft^3] h_b <- height  # get horizontal flow: Fv <- get_greenampt_horiz_flow_integrated(theta_0, theta_s, Ksat, h_b, h_0, times = times) flow_horizontal <- Fv * (width * 2 + length * 2)  fcum_vert <- get_greenampt_flow_numerical(theta_0, theta_s, Ksat, h_b, h_0, times) flow_vertical <- fcum_vert * width * length flow_vertical <- units::set_units(flow_vertical, units(flow_horizontal))  flow <- flow_horizontal + flow_vertical flow ## 9.301142 [ft^3]"},{"path":"/articles/recharge-pit-models.html","id":"cylindrical-pit-with-half-spherical-bottom-flow","dir":"Articles","previous_headings":"","what":"Cylindrical pit with half-spherical bottom flow","title":"recharge-pit-models","text":"pit represented radius depth. Water flows radially outwards creating expanding cylinder along depth pit. bottom pit, water flows radially outward create downward half-sphere. Gravity (.e., elevation gradient) fully ignored make math tractable. may reasonable assumption pit deep enough pressure head gradient much greater 1.","code":""},{"path":"/articles/recharge-pit-models.html","id":"model-with-two-soil-layers","dir":"Articles","previous_headings":"Cylindrical pit with half-spherical bottom flow","what":"Model with two soil layers","title":"recharge-pit-models","text":"Note different soil layers can modeled provided flowlines intersect soil boundary. words, possible model multiple soil layers bottom pit flow region horizontal. However, confining layer bottom pit modeled. , model recharge pit 6 ft deep 2 ft radius. pit dug 2-layer soil profile low-conductivity (Clay) surface layer 2 ft underlain high-conductivity layer (Sand) extends bottom pit. get values \\(K_{sat}\\) rawls_soils: use get_greenampt_cyl_flow_integrated model horizontal cylindrical flow layer, get_greenampt_hsphere_numerical obtain flow bottom. clay top layer, use bottom pressure head 2 ft (\\(h_b = 2 ft\\)), depth 2 ft (\\(d = 2 ft\\)), radius 2 ft (\\(r_b = 2 ft\\)) hydraulic conductivity clay (\\(K_{sat} = 0.06 cm/h\\)). assume porosity 0.4, initial volumetric water content 0.2. finally, discretize layer 2 sections radial outward flow calculated 1 foot increments (2 ft depth / 2 sections = 1 ft/section). assume small negative pressure head soil. sand layer, use bottom pressure head 6 ft (\\(h_b = 6 ft\\)), depth 4 ft (\\(d = 4 ft\\)), radius 2 ft (\\(r_b = 2 ft\\)) hydraulic conductivity sand (\\(K_{sat} = 21 cm/h\\)). keep porosity initial VWC, use 1 foot discrete sections (.e., 4 sections). Next, get flow bottom. requires inputs sand layer depth 6 ft. Finally, obtain total recharge sum three outputs:  can view contribution models combining data data.frame plotting:","code":"library(dplyr) rawls_soils %>%    filter(texture_class %in% c(\"Sand\",\"Clay\")) %>%    select(texture_class, Ksat_cm_per_h, porosity_effective) ## # A tibble: 2 × 3 ##   texture_class Ksat_cm_per_h porosity_effective ##   <chr>                 <dbl>              <dbl> ## 1 Sand                  21                 0.417 ## 2 Clay                   0.06              0.385 times <- set_units(c(1,3,5), \"hr\") # units of length^2 Fcum_clay_horiz <- get_greenampt_cyl_flow_integrated(theta_0 = 0.2, # unitless                                                      theta_s = 0.4,                                                       Ksat = set_units(0.06, \"cm/h\"),                                                       h_b = set_units(2, \"ft\"),                                                       h_0 = set_units(-10, \"cm\"),                                                       r_b = set_units(2, \"ft\"),                                                       times = times,                                                      F_units = \"ft^3\",                                                       num_sections = 2,                                                       d = set_units(2, \"ft\")) Fcum_sand_horiz <- get_greenampt_cyl_flow_integrated(theta_0 = 0.2, # unitless                                                      theta_s = 0.4,                                                       Ksat = set_units(23, \"cm/h\"),                                                       h_b = set_units(6, \"ft\"),                                                       h_0 = set_units(-10, \"cm\"),                                                       r_b = set_units(2, \"ft\"),                                                       times = times,                                                      F_units = \"ft^3\",                                                       num_sections = 4,                                                       d = set_units(4, \"ft\")) Fcum_sand_bottom <- get_greenampt_hsphere_numerical(theta_0 = 0.2, # unitless                                                     theta_s = 0.4,                                                      Ksat = set_units(23, \"cm/h\"),                                                      h_b = set_units(6, \"ft\"),                                                      h_0 = set_units(-10, \"cm\"),                                                      r_b = set_units(2, \"ft\"),                                                      times = times,                                                     F_units = \"ft^3\") library(ggplot2) Fcum <- Fcum_clay_horiz + Fcum_sand_horiz + Fcum_sand_bottom ggplot() + geom_point(aes(times, Fcum)) library(tidyr) library(dplyr) df <- as.data.frame(bind_cols(times_h = rep(times, 3),                            recharge_cu_ft = c(Fcum_clay_horiz,Fcum_sand_horiz, Fcum_sand_bottom),                            layer = rep(c(\"Clay horiz\", \"Sand horiz\", \"Sand bottom\"), each = length(times)))) df$layer <- factor(df$layer, levels = c(\"Clay horiz\", \"Sand horiz\", \"Sand bottom\"))  ggplot(df) +    geom_bar(aes(as.character(times_h), recharge_cu_ft, fill = layer), stat = 'identity') +   xlab(\"Time [h]\") + ylab(\"Cumulative recharge\")"},{"path":"/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"package maintainer. Maintainer.","code":""},{"path":"/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Ww (2024). rechargepits: Package (Title Case). R package version 0.1.0.","code":"@Manual{,   title = {rechargepits: What the Package Does (Title Case)},   author = {Who wrote it},   year = {2024},   note = {R package version 0.1.0}, }"},{"path":"/index.html","id":"rechargepits","dir":"","previous_headings":"","what":"What the Package Does (Title Case)","title":"What the Package Does (Title Case)","text":"goal rechargepits model simple recharge geometries using assumptions Green-Ampt equation.","code":""},{"path":"/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"What the Package Does (Title Case)","text":"can install development version rechargepits GitHub :","code":"# install.packages(\"devtools\") devtools::install_github(\"gopalpenny/rechargepits\")"},{"path":"/index.html","id":"package-website","dir":"","previous_headings":"","what":"Package website","title":"What the Package Does (Title Case)","text":"information, see package website github.io.","code":""},{"path":"/reference/get_bc_hydraulic_head.html","id":null,"dir":"Reference","previous_headings":"","what":"Brooks-Corey Water Retention Curve — get_bc_hydraulic_head","title":"Brooks-Corey Water Retention Curve — get_bc_hydraulic_head","text":"Brooks-Corey Water Retention Curve","code":""},{"path":"/reference/get_bc_hydraulic_head.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Brooks-Corey Water Retention Curve — get_bc_hydraulic_head","text":"","code":"get_bc_hydraulic_head(theta, theta_r, theta_s, h_d, lambda)"},{"path":"/reference/get_bc_hydraulic_head.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Brooks-Corey Water Retention Curve — get_bc_hydraulic_head","text":"theta volumetric water content theta_r residual water content theta_s saturated water content h_d air entry pressure (units length) lambda curve shape, dimensionless","code":""},{"path":"/reference/get_bc_hydraulic_head.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Brooks-Corey Water Retention Curve — get_bc_hydraulic_head","text":"See: Pan, T., Hou, S., Liu, Y., & Tan, Q. (2019). Comparison three models fitting soil water retention curves degraded alpine meadow region. Scientific Reports, 9(1), 18407.","code":""},{"path":"/reference/get_bc_hydraulic_head.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Brooks-Corey Water Retention Curve — get_bc_hydraulic_head","text":"","code":"# example code library(units) #> udunits database from /Library/Frameworks/R.framework/Versions/4.3-arm64/Resources/library/units/share/udunits/udunits2.xml  sand_rawls <- get_rawls_soil(soil_name = \"Sandy loam\") theta <- seq(0.15, sand_rawls$porosity, length.out = 100) theta_r <- sand_rawls$theta_r theta_s <- sand_rawls$porosity h_d <- set_units(sand_rawls$bubbling_pressure_arithmetic_cm, \"cm\") # should have units of length lambda <- sand_rawls$pore_size_distrib_arithmetic hydraulic_head <- get_bc_hydraulic_head(theta, theta_r, theta_s, h_d, lambda)  library(tidyr) rel_theta <- data.frame(rel_theta = seq(0.01, 1, length.out = 100)) df <- crossing(rawls_soils, rel_theta) df$theta <- df$rel_theta * (df$porosity - df$theta_r) + df$theta_r df$hydraulic_head <- get_bc_hydraulic_head(   theta = theta,   theta_r = df$theta_r,   theta_s = df$porosity,   h_d = set_units(df$bubbling_pressure_arithmetic_cm, \"cm\"),   lambda = df$pore_size_distrib_arithmetic) df$hydraulic_head_cm <- as.numeric(df$hydraulic_head)  library(ggplot2) ggplot(df) +   geom_line(aes(theta, hydraulic_head_cm, color = texture_class, linetype = texture_class)) +   ylim(c(-1000, 0)) +   scale_linetype_manual(values = rep(c(\"solid\",\"dashed\",\"dotted\"),4)) #> Warning: Removed 346 rows containing missing values (`geom_line()`)."},{"path":"/reference/get_greenampt_cyl_flow_integrated.html","id":null,"dir":"Reference","previous_headings":"","what":"Get greenampt cylindrical flow integrated — get_greenampt_cyl_flow_integrated","title":"Get greenampt cylindrical flow integrated — get_greenampt_cyl_flow_integrated","text":"function calculates green-ampt cylindrical flow (using `get_greenampt_cyl_horiz_numerical`) number discrete vertical sections. allows calculation volumetric flow moving horizontally outward vertical, cylindrical pit filled water. instance, consider idealized example cylindrical recharge well radius 2 ft (`r_b`), depth 4 ft (`h_b`), screened bottom 3 ft (`d`). case, might specify `num_sections = 3`, case function estimate planar radial flow (\\(F_r\\)) using `get_greenampt_cyl_horiz_numerical` \\(h_b \\\\{1.5, 2.5, 3.5 ft\\}\\). volumetric flow estimated : $$F_{c,total} = 1 ft \\ times (F_r |_{h_b = 1.5} + F_r |_{h_b = 2.5} + F_r |_{h_b = 3.5})$$ \\(1 ft\\) front represents width section.","code":""},{"path":"/reference/get_greenampt_cyl_flow_integrated.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get greenampt cylindrical flow integrated — get_greenampt_cyl_flow_integrated","text":"","code":"get_greenampt_cyl_flow_integrated(   theta_0,   theta_s,   Ksat,   h_b,   h_0,   r_b,   times,   F_units = \"ft^2\",   num_sections = 5,   d = NULL )"},{"path":"/reference/get_greenampt_cyl_flow_integrated.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get greenampt cylindrical flow integrated — get_greenampt_cyl_flow_integrated","text":"theta_0 Soil volumetric water content prior event theta_s Soil porosity Ksat Saturated hydraulic conductivity h_b Hydraulic head soil surface boundary h_0 Hydraulic head soil prior event r_b radius centroid free water--soil boundary times times calculate cumulative infiltration F_units character indicating areal (L^2) `units` output num_sections Number discrete bins calculate recharge d Depth integrated. NULL, set h_b","code":""},{"path":"/reference/get_greenampt_cyl_flow_integrated.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get greenampt cylindrical flow integrated — get_greenampt_cyl_flow_integrated","text":"function returns cumulative volumetric infiltration.","code":""},{"path":"/reference/get_greenampt_cyl_flow_integrated.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get greenampt cylindrical flow integrated — get_greenampt_cyl_flow_integrated","text":"","code":"library(units) r_b <- set_units(2, \"ft\") # length theta_0 <- 0.2 # unitless theta_s <- 0.35 # unitless times <- set_units(c(0, 0.5, 1, 5), \"hr\") Ksat <- set_units(0.2, \"cm/h\") # length / time h_b <- set_units(4, \"ft\") # hydraulic head (length) h_0 <- set_units(-10, \"cm\") # hydraulic head (length) d <- set_units(3, \"ft\") num_sections <- 3 F_v_cum <- get_greenampt_cyl_flow_integrated(theta_0, theta_s, Ksat, h_b, h_0, r_b, times,                                              F_units = \"ft^2\", num_sections = 3, d = d) #> Error: cannot convert ft^3 into ft^2  # This is equivalent to a discretized version of `get_greenampt_cyl_horiz_numerical`: Fc_1_5 <- get_greenampt_cyl_horiz_numerical(theta_0, theta_s, Ksat,                 h_b = set_units(1.5,\"ft\"), h_0, r_b, times, F_units = \"ft^2\") Fc_2_5 <- get_greenampt_cyl_horiz_numerical(theta_0, theta_s, Ksat,                 h_b = set_units(2.5,\"ft\"), h_0, r_b, times, F_units = \"ft^2\") Fc_3_5 <- get_greenampt_cyl_horiz_numerical(theta_0, theta_s, Ksat,                 h_b = set_units(3.5,\"ft\"), h_0, r_b, times, F_units = \"ft^2\") Fc_sum <- d / num_sections * (Fc_1_5 + Fc_2_5 + Fc_3_5) F_v_cum #> Error in eval(expr, envir, enclos): object 'F_v_cum' not found Fc_sum #> Units: [ft^3] #> [1] 0.000000 2.080774 3.006697 7.300690"},{"path":"/reference/get_greenampt_cyl_horiz_numerical.html","id":null,"dir":"Reference","previous_headings":"","what":"Green-Ampt cylindrical horizontal flow — get_greenampt_cyl_horiz_numerical","title":"Green-Ampt cylindrical horizontal flow — get_greenampt_cyl_horiz_numerical","text":"function models saturated outward radial flow circular saturated surface horizontally soil profile. assumptions Green-Ampt equation, except effect gravity flow assumed horizontal. equation includes \\(r_f\\), radius edge front center cylinder: $$t = \\frac{\\Delta \\theta}{4 (h_b - h_0)} \\Big[r_b^2 + r_f^2 (2  \\ln \\frac{r_f}{r_b} - 1) \\Big]$$ straightforward convert cumulative infiltratioj \\(F_c\\) \\(r_f\\): $$F_c = \\pi (r_f^2 - r_b^2) \\Delta \\theta$$ reverse: $$r_f = \\sqrt{ \\frac{F_c}{\\pi \\Delta \\theta} + r_b^2}$$","code":""},{"path":"/reference/get_greenampt_cyl_horiz_numerical.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Green-Ampt cylindrical horizontal flow — get_greenampt_cyl_horiz_numerical","text":"","code":"get_greenampt_cyl_horiz_numerical(   theta_0,   theta_s,   Ksat,   h_b,   h_0,   r_b,   times,   F_units = \"ft^2\" )"},{"path":"/reference/get_greenampt_cyl_horiz_numerical.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Green-Ampt cylindrical horizontal flow — get_greenampt_cyl_horiz_numerical","text":"theta_0 Soil volumetric water content prior event theta_s Soil porosity Ksat Saturated hydraulic conductivity h_b Hydraulic head soil surface boundary h_0 Hydraulic head soil prior event r_b radius centroid free water--soil boundary times times calculate cumulative infiltration F_units character indicating areal (L^2) `units` output","code":""},{"path":"/reference/get_greenampt_cyl_horiz_numerical.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Green-Ampt cylindrical horizontal flow — get_greenampt_cyl_horiz_numerical","text":"Returns cumulative amount infiltration time `times`.","code":""},{"path":"/reference/get_greenampt_cyl_horiz_numerical.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Green-Ampt cylindrical horizontal flow — get_greenampt_cyl_horiz_numerical","text":"","code":"library(units) r_b <- set_units(2, \"ft\") # length theta_0 <- 0.2 # unitless theta_s <- 0.35 # unitless F_c <- set_units(c(1, 5, 10, 20), \"ft^2\") # units of length^2 Ksat <- set_units(0.2, \"cm/h\") # length / time h_b <- set_units(6, \"ft\") # hydraulic head (length) h_0 <- set_units(-10, \"cm\") # hydraulic head (length) times <- get_greenampt_cyl_horiz_time(theta_0, theta_s, F_c, Ksat, h_b, h_0, r_b) F_c_calculated <- get_greenampt_cyl_horiz_numerical(theta_0, theta_s, Ksat, h_b, h_0,                                                     r_b, times, F_units = \"ft^2\")"},{"path":"/reference/get_greenampt_cyl_horiz_time.html","id":null,"dir":"Reference","previous_headings":"","what":"Green-Ampt cylindrical horizontal flow time — get_greenampt_cyl_horiz_time","title":"Green-Ampt cylindrical horizontal flow time — get_greenampt_cyl_horiz_time","text":"function models saturated outward radial flow circular saturated surface horizontally soil profile. assumptions Green-Ampt equation, except effect gravity flow assumed horizontal. equation includes \\(r_f\\), radius edge front center cylinder: $$t = \\frac{\\Delta \\theta}{4 (h_b - h_0)} \\Big[r_b^2 + r_f^2 (2  \\ln \\frac{r_f}{r_b} - 1) \\Big]$$ straightforward convert cumulative infiltration \\(F_c\\) \\(r_f\\): $$F_c = \\pi (r_f^2 - r_b^2) \\Delta \\theta$$ reverse: $$r_f = \\sqrt{ \\frac{F_c}{\\pi \\Delta \\theta} + r_b^2}$$","code":""},{"path":"/reference/get_greenampt_cyl_horiz_time.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Green-Ampt cylindrical horizontal flow time — get_greenampt_cyl_horiz_time","text":"","code":"get_greenampt_cyl_horiz_time(theta_0, theta_s, F_c, Ksat, h_b, h_0, r_b)"},{"path":"/reference/get_greenampt_cyl_horiz_time.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Green-Ampt cylindrical horizontal flow time — get_greenampt_cyl_horiz_time","text":"theta_0 Soil volumetric water content prior event theta_s Soil porosity F_c cumulative radial infiltration cylinder (units area L^2) Ksat Saturated hydraulic conductivity h_b Hydraulic head soil surface boundary h_0 Hydraulic head soil prior event r_b radius centroid free water--soil boundary","code":""},{"path":"/reference/get_greenampt_cyl_horiz_time.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Green-Ampt cylindrical horizontal flow time — get_greenampt_cyl_horiz_time","text":"Returns time cumulative amount infiltration occurs.","code":""},{"path":"/reference/get_greenampt_cyl_horiz_time.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Green-Ampt cylindrical horizontal flow time — get_greenampt_cyl_horiz_time","text":"","code":"library(units) r_b <- set_units(2, \"ft\") # length theta_0 <- 0.2 # unitless theta_s <- 0.35 # unitless F_c <- set_units(10, \"ft^2\") # units of length^2 Ksat <- set_units(0.2, \"cm/h\") # length / time h_b <- set_units(6, \"ft\") # hydraulic head (length) h_0 <- set_units(-10, \"cm\") # hydraulic head (length) times <- get_greenampt_cyl_horiz_time(theta_0, theta_s, F_c, Ksat, h_b, h_0, r_b)"},{"path":"/reference/get_greenampt_flow_numerical.html","id":null,"dir":"Reference","previous_headings":"","what":"Green-Ampt flow — get_greenampt_flow_numerical","title":"Green-Ampt flow — get_greenampt_flow_numerical","text":"function models Green-Ampt equation, saturated surface flowing vertically downward soil profile. assumptions : 1. Homogeneous soil initial water content (theta_0) 2. Constant pressure head (h_0) wetting front 3. Saturated soil wetting front 4. Continuous supply water constant head (h_b) soil surface boundary assumptions, amount time particular infiltration depth (Fcum) can calculated using Darcy's law : $$t = \\frac{1}{K_{sat}}\\Big[F - \\Delta \\theta (h_b - h_0) \\ln (1 + \\frac{F}{\\Delta \\theta (h_b - h_0)}) \\Big]$$ cumulative infiltration found using numerical root solver, `uniroot`.","code":""},{"path":"/reference/get_greenampt_flow_numerical.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Green-Ampt flow — get_greenampt_flow_numerical","text":"","code":"get_greenampt_flow_numerical(theta_0, theta_s, Ksat, h_b, h_0, times)"},{"path":"/reference/get_greenampt_flow_numerical.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Green-Ampt flow — get_greenampt_flow_numerical","text":"theta_0 Soil volumetric water content prior event theta_s Soil porosity Ksat Saturated hydraulic conductivity h_b Hydraulic head soil surface boundary h_0 Hydraulic head soil prior event times Times calculate total infiltration","code":""},{"path":"/reference/get_greenampt_flow_numerical.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Green-Ampt flow — get_greenampt_flow_numerical","text":"Returns cumulative infiltration times given `times`.","code":""},{"path":"/reference/get_greenampt_flow_numerical.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Green-Ampt flow — get_greenampt_flow_numerical","text":"","code":"library(units) theta_0 <- 0.2 # unitless theta_s <- 0.35 # unitless Fcum <- set_units(1:20, \"mm\") # depth Ksat <- set_units(0.2, \"cm/h\") # length / time h_b <- set_units(6, \"ft\") # hydraulic head (length) h_0 <- set_units(-10, \"cm\") # hydraulic head (length) times <- set_units(seq(5, 60, by= 5), \"min\") fcum <- get_greenampt_flow_numerical(theta_0, theta_s, Ksat, h_b, h_0, times) # Double check that we get the original times back with the Green-Ampt equation set_units(get_greenampt_time(theta_0, theta_s, fcum, Ksat, h_b, h_0),\"min\") #> Units: [min] #>  [1]  5.000000  9.999995 15.000000 19.999970 24.999991 29.999997 34.999999 #>  [8] 39.999999 45.000000 49.999987 54.999993 59.999996"},{"path":"/reference/get_greenampt_horiz_flow.html","id":null,"dir":"Reference","previous_headings":"","what":"Green-Ampt horizontal flow — get_greenampt_horiz_flow","title":"Green-Ampt horizontal flow — get_greenampt_horiz_flow","text":"function models saturated horizontal flow saturated surface soil profile. assumptions Green-Ampt equation, except effect gravity flow assumed horizontal. equation : $$F = \\sqrt{2 \\Delta \\theta K_{sat} (h_b - h_0) t}$$","code":""},{"path":"/reference/get_greenampt_horiz_flow.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Green-Ampt horizontal flow — get_greenampt_horiz_flow","text":"","code":"get_greenampt_horiz_flow(theta_0, theta_s, Ksat, h_b, h_0, times)"},{"path":"/reference/get_greenampt_horiz_flow.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Green-Ampt horizontal flow — get_greenampt_horiz_flow","text":"theta_0 Soil volumetric water content prior event theta_s Soil porosity Ksat Saturated hydraulic conductivity h_b Hydraulic head soil surface boundary h_0 Hydraulic head soil prior event times Times calculate total infiltration","code":""},{"path":"/reference/get_greenampt_horiz_flow.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Green-Ampt horizontal flow — get_greenampt_horiz_flow","text":"Returns cumulative infiltration specified times","code":""},{"path":"/reference/get_greenampt_horiz_flow.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Green-Ampt horizontal flow — get_greenampt_horiz_flow","text":"","code":"library(units) theta_0 <- 0.2 # unitless theta_s <- 0.35 # unitless Fcum <- set_units(20, \"mm\") # depth Ksat <- set_units(0.2, \"cm/h\") # length / time h_b <- set_units(6, \"ft\") # hydraulic head (length) h_0 <- set_units(-10, \"cm\") # hydraulic head (length) times <- set_units(seq(5, 60, by= 5), \"min\") Fcum <- get_greenampt_horiz_flow(theta_0, theta_s, Ksat, h_b, h_0, times)"},{"path":"/reference/get_greenampt_horiz_flow_integrated.html","id":null,"dir":"Reference","previous_headings":"","what":"Horizontal Green-Ampt flow integrated — get_greenampt_horiz_flow_integrated","title":"Horizontal Green-Ampt flow integrated — get_greenampt_horiz_flow_integrated","text":"function models saturated horizontal flow saturated surface soil profile. assumptions Green-Ampt equation, except effect gravity flow assumed horizontal. function integrates vertical depth pit hydraulic head boundary goes (h_b - thickness) h_b. equation : $$F_v = \\sqrt{\\frac{8}{9} \\Delta \\theta K_{sat} t} \\Big[(h_b - h_0)^{3/2} - (h_b - d - h_0)^{3/2} \\Big]$$","code":""},{"path":"/reference/get_greenampt_horiz_flow_integrated.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Horizontal Green-Ampt flow integrated — get_greenampt_horiz_flow_integrated","text":"","code":"get_greenampt_horiz_flow_integrated(   theta_0,   theta_s,   Ksat,   h_b,   h_0,   times,   d = NULL )"},{"path":"/reference/get_greenampt_horiz_flow_integrated.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Horizontal Green-Ampt flow integrated — get_greenampt_horiz_flow_integrated","text":"theta_0 Soil volumetric water content prior event theta_s Soil porosity Ksat Saturated hydraulic conductivity h_b Hydraulic head soil surface boundary h_0 Hydraulic head soil prior event times Times calculate total infiltration d Depth integrated. NULL, set h_b","code":""},{"path":"/reference/get_greenampt_horiz_flow_integrated.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Horizontal Green-Ampt flow integrated — get_greenampt_horiz_flow_integrated","text":"Returns time cumulative amount infiltration occurs.","code":""},{"path":"/reference/get_greenampt_horiz_flow_integrated.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Horizontal Green-Ampt flow integrated — get_greenampt_horiz_flow_integrated","text":"","code":"library(units) theta_0 <- 0.2 # unitless theta_s <- 0.35 # unitless Ksat <- set_units(0.2, \"cm/h\") # length / time h_b <- set_units(6, \"ft\") # hydraulic head (length) h_0 <- set_units(-10, \"cm\") # hydraulic head (length)  Fv <- get_greenampt_horiz_flow_integrated(theta_0, theta_s,         Ksat, h_b, h_0, times = set_units(1,\"hr\"), d = NULL)  # Get infiltration over a 1 mm differential depth to compare with the point infiltration Fv_dv <- get_greenampt_horiz_flow_integrated(theta_0, theta_s,         Ksat, h_b, h_0, times = set_units(1,\"hr\"), d = set_units(1, \"mm\")) Fv_point <- Fv_dv/ set_units(1, \"mm\") Fv_point #> 34.01441 [mm] # Get the point infiltration F_point <- get_greenampt_horiz_flow(theta_0, theta_s, Ksat, h_b, h_0,         times = set_units(1,\"hr\")) %>% set_units(\"mm\") F_point #> 34.01882 [mm] # percent error: (Fv_point - F_point) / F_point * 100 #> -0.01296255 [1]"},{"path":"/reference/get_greenampt_horiz_time.html","id":null,"dir":"Reference","previous_headings":"","what":"Green-Ampt horizontal flow time — get_greenampt_horiz_time","title":"Green-Ampt horizontal flow time — get_greenampt_horiz_time","text":"function models saturated horizontal flow saturated surface soil profile. assumptions Green-Ampt equation, except effect gravity flow assumed horizontal. equation : $$t = \\frac{F^2}{2 \\Delta \\theta K_{sat} (h_b - h_0)}$$","code":""},{"path":"/reference/get_greenampt_horiz_time.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Green-Ampt horizontal flow time — get_greenampt_horiz_time","text":"","code":"get_greenampt_horiz_time(theta_0, theta_s, Fcum, Ksat, h_b, h_0)"},{"path":"/reference/get_greenampt_horiz_time.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Green-Ampt horizontal flow time — get_greenampt_horiz_time","text":"theta_0 Soil volumetric water content prior event theta_s Soil porosity Fcum cumulative infiltration mm water equivalent Ksat Saturated hydraulic conductivity h_b Hydraulic head soil surface boundary h_0 Hydraulic head soil prior event","code":""},{"path":"/reference/get_greenampt_horiz_time.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Green-Ampt horizontal flow time — get_greenampt_horiz_time","text":"Returns time cumulative amount infiltration occurs.","code":""},{"path":"/reference/get_greenampt_horiz_time.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Green-Ampt horizontal flow time — get_greenampt_horiz_time","text":"","code":"library(units) theta_0 <- 0.2 # unitless theta_s <- 0.35 # unitless Fcum <- set_units(20, \"mm\") # depth Ksat <- set_units(0.2, \"cm/h\") # length / time h_b <- set_units(6, \"ft\") # hydraulic head (length) h_0 <- set_units(-10, \"cm\") # hydraulic head (length) times <- get_greenampt_horiz_time(theta_0, theta_s, Fcum, Ksat, h_b, h_0)"},{"path":"/reference/get_greenampt_hsphere_numerical.html","id":null,"dir":"Reference","previous_headings":"","what":"Green-Ampt half-spherical pressure flow — get_greenampt_hsphere_numerical","title":"Green-Ampt half-spherical pressure flow — get_greenampt_hsphere_numerical","text":"function models saturated flow wetted half-spherical surface soil profile. Flow driven pressure gravity ignored. might mimic situation subsurface recharge pressure head gradient significantly larger elevation head gradient. Otherwise, assumptions Green-Ampt equation. equation includes \\(r_f\\), radius edge front center sphere. equation calculate time required achieve quantum recharge : $$t = \\frac{\\Delta \\theta}{K_{sat} (h_b - h_0)}  \\Bigg[ \\frac{r_f^3}{3 r_b}  - \\frac{r_f^2}{2} + \\frac{r_b^2}{6} \\Bigg]$$ straightforward convert cumulative infiltration \\(F_c\\) \\(r_f\\): $$F_s = \\Delta \\theta \\pi \\frac{2}{3}\\Big( r_f^3 - r_b^3 \\Big)$$ $$r_f = \\Big( \\frac{3 F_s}{2 \\Delta \\theta \\pi} + r_b^3 \\Big)^{1/3}$$","code":""},{"path":"/reference/get_greenampt_hsphere_numerical.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Green-Ampt half-spherical pressure flow — get_greenampt_hsphere_numerical","text":"","code":"get_greenampt_hsphere_numerical(   theta_0,   theta_s,   Ksat,   h_b,   h_0,   r_b,   times,   F_units = \"ft^3\" )"},{"path":"/reference/get_greenampt_hsphere_numerical.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Green-Ampt half-spherical pressure flow — get_greenampt_hsphere_numerical","text":"theta_0 Soil volumetric water content prior event theta_s Soil porosity Ksat Saturated hydraulic conductivity h_b Hydraulic head soil surface boundary h_0 Hydraulic head soil prior event r_b radius centroid free water--soil boundary times times calculate cumulative infiltration F_units character indicating volumetric (L^3) `units` output","code":""},{"path":"/reference/get_greenampt_hsphere_numerical.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Green-Ampt half-spherical pressure flow — get_greenampt_hsphere_numerical","text":"Returns cumulative amount volumetric infiltration occurs half sphere.","code":""},{"path":"/reference/get_greenampt_hsphere_numerical.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Green-Ampt half-spherical pressure flow — get_greenampt_hsphere_numerical","text":"","code":"library(units) r_b <- set_units(2, \"ft\") # length theta_0 <- 0.2 # unitless theta_s <- 0.35 # unitless F_s <- set_units(c(1, 5, 10, 20), \"ft^3\") # units of length^2 Ksat <- set_units(0.2, \"cm/h\") # length / time h_b <- set_units(6, \"ft\") # hydraulic head (length) h_0 <- set_units(-10, \"cm\") # hydraulic head (length) times <- get_greenampt_hsphere_time(theta_0, theta_s, F_s, Ksat, h_b, h_0, r_b) F_s_calc <- get_greenampt_hsphere_numerical(theta_0, theta_s, Ksat, h_b, h_0, r_b, times) F_s_calc #> Units: [ft^3] #> [1]  1.000002  4.999985  9.999978 20.000015"},{"path":"/reference/get_greenampt_hsphere_time.html","id":null,"dir":"Reference","previous_headings":"","what":"Green-Ampt half-spherical pressure flow time — get_greenampt_hsphere_time","title":"Green-Ampt half-spherical pressure flow time — get_greenampt_hsphere_time","text":"function models saturated flow wetted half-spherical surface soil profile. Flow driven pressure gravity ignored. might mimic situation subsurface recharge pressure head gradient significantly larger elevation head gradient. Otherwise, assumptions Green-Ampt equation. equation includes \\(r_f\\), radius edge front center sphere. equation calculate time required achieve quantum recharge : $$t = \\frac{\\Delta \\theta}{K_{sat} (h_b - h_0)}  \\Bigg[ \\frac{r_f^3}{3 r_b}  - \\frac{r_f^2}{2} + \\frac{r_b^2}{6} \\Bigg]$$ straightforward convert cumulative infiltration \\(F_c\\) \\(r_f\\): $$F_s = \\Delta \\theta \\pi \\frac{2}{3}\\Big( r_f^3 - r_b^3 \\Big)$$ $$r_f = \\Big( \\frac{3 F_s}{2 \\Delta \\theta \\pi} + r_b^3 \\Big)^{1/3}$$","code":""},{"path":"/reference/get_greenampt_hsphere_time.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Green-Ampt half-spherical pressure flow time — get_greenampt_hsphere_time","text":"","code":"get_greenampt_hsphere_time(theta_0, theta_s, F_s, Ksat, h_b, h_0, r_b)"},{"path":"/reference/get_greenampt_hsphere_time.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Green-Ampt half-spherical pressure flow time — get_greenampt_hsphere_time","text":"theta_0 Soil volumetric water content prior event theta_s Soil porosity F_s cumulative radial infiltration cylinder (units volume L^3) Ksat Saturated hydraulic conductivity h_b Hydraulic head soil surface boundary h_0 Hydraulic head soil prior event r_b radius centroid free water--soil boundary","code":""},{"path":"/reference/get_greenampt_hsphere_time.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Green-Ampt half-spherical pressure flow time — get_greenampt_hsphere_time","text":"Returns time cumulative amount volumetric infiltration occurs half sphere.","code":""},{"path":"/reference/get_greenampt_hsphere_time.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Green-Ampt half-spherical pressure flow time — get_greenampt_hsphere_time","text":"","code":"library(units) r_b <- set_units(2, \"ft\") # length theta_0 <- 0.2 # unitless theta_s <- 0.35 # unitless F_s <- set_units(10, \"ft^3\") # units of length^2 Ksat <- set_units(0.2, \"cm/h\") # length / time h_b <- set_units(6, \"ft\") # hydraulic head (length) h_0 <- set_units(-10, \"cm\") # hydraulic head (length) times <- get_greenampt_hsphere_time(theta_0, theta_s, F_s, Ksat, h_b, h_0, r_b)"},{"path":"/reference/get_greenampt_time.html","id":null,"dir":"Reference","previous_headings":"","what":"Green-Ampt flow time — get_greenampt_time","title":"Green-Ampt flow time — get_greenampt_time","text":"function models Green-Ampt equation, saturated surface flowing vertically downward soil profile. assumptions : 1. Homogeneous soil initial water content (theta_0) 2. Constant pressure head (h_0) wetting front 3. Saturated soil wetting front 4. Continuous supply water constant head (h_b) soil surface boundary assumptions, amount time particular infiltration depth (Fcum) can calculated using Darcy's law : $$t = \\frac{1}{K_{sat}}\\Big[F - \\Delta \\theta (h_b - h_0) \\ln (1 + \\frac{F}{\\Delta \\theta (h_b - h_0)}) \\Big]$$","code":""},{"path":"/reference/get_greenampt_time.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Green-Ampt flow time — get_greenampt_time","text":"","code":"get_greenampt_time(theta_0, theta_s, Fcum, Ksat, h_b, h_0)"},{"path":"/reference/get_greenampt_time.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Green-Ampt flow time — get_greenampt_time","text":"theta_0 Soil volumetric water content prior event theta_s Soil porosity Fcum cumulative infiltration mm water equivalent Ksat Saturated hydraulic conductivity h_b Hydraulic head soil surface boundary h_0 Hydraulic head soil prior event","code":""},{"path":"/reference/get_greenampt_time.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Green-Ampt flow time — get_greenampt_time","text":"Returns time cumulative amount infiltration occurs.","code":""},{"path":"/reference/get_greenampt_time.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Green-Ampt flow time — get_greenampt_time","text":"","code":"library(units) theta_0 <- 0.2 # unitless theta_s <- 0.35 # unitless Fcum <- set_units(1:20, \"mm\") # depth Ksat <- set_units(0.2, \"cm/h\") # length / time h_b <- set_units(6, \"ft\") # hydraulic head (length) h_0 <- set_units(-10, \"cm\") # hydraulic head (length) get_greenampt_time(theta_0, theta_s, Fcum, Ksat, h_b, h_0) #> Units: [h] #>  [1] 0.0008621092 0.0034405339 0.0077235112 0.0136993988 0.0213566732 #>  [6] 0.0306839281 0.0416698731 0.0543033317 0.0685732399 0.0844686452 #> [11] 0.1019787042 0.1210926820 0.1417999501 0.1640899855 0.1879523692 #> [16] 0.2133767845 0.2403530159 0.2688709481 0.2989205640 0.3304919441"},{"path":"/reference/get_greenampt_x_roots.html","id":null,"dir":"Reference","previous_headings":"","what":"Get green ampt roots — get_greenampt_x_roots","title":"Get green ampt roots — get_greenampt_x_roots","text":"Get green ampt roots","code":""},{"path":"/reference/get_greenampt_x_roots.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get green ampt roots — get_greenampt_x_roots","text":"","code":"get_greenampt_x_roots(times, x_units, green_ampt_function_name, ...)"},{"path":"/reference/get_greenampt_x_roots.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get green ampt roots — get_greenampt_x_roots","text":"times Times calculate total infiltration x_units Units output variable green_ampt_function_name Name function use root finding ... Parameters passed function named `green_ampt_function`","code":""},{"path":"/reference/get_greenampt_x_roots.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get green ampt roots — get_greenampt_x_roots","text":"","code":"library(units) theta_0 <- 0.2 # unitless theta_s <- 0.35 # unitless Fcum <- set_units(20, \"mm\") # depth Ksat <- set_units(0.2, \"cm/h\") # length / time h_b <- set_units(6, \"ft\") # hydraulic head (length) h_0 <- set_units(-10, \"cm\") # hydraulic head (length) times <- get_greenampt_horiz_time(theta_0, theta_s, Fcum, Ksat, h_b, h_0) times <- set_units(seq(10,60, by = 5), \"min\") Fcum_horiz <- get_greenampt_x_roots(times = times, x_units = \"mm\",    green_ampt_function = \"get_greenampt_horiz_time\",    theta_0 = theta_0, theta_s = theta_s, Ksat = Ksat, h_b = h_b, h_0 = h_0) Fcum_vert <- get_greenampt_x_roots(times = times, x_units = \"mm\",    green_ampt_function = \"get_greenampt_time\",    theta_0 = theta_0, theta_s = theta_s, Ksat = Ksat, h_b = h_b, h_0 = h_0)"},{"path":"/reference/get_pit_recharge_rectangular.html","id":null,"dir":"Reference","previous_headings":"","what":"Rectangular pit flow — get_pit_recharge_rectangular","title":"Rectangular pit flow — get_pit_recharge_rectangular","text":"Horizontal vertical parallel flow rectangular pit","code":""},{"path":"/reference/get_pit_recharge_rectangular.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Rectangular pit flow — get_pit_recharge_rectangular","text":"","code":"get_pit_recharge_rectangular(   height,   length,   width,   theta_s,   Ksat,   theta_0,   h_0,   times )"},{"path":"/reference/get_pit_recharge_rectangular.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Rectangular pit flow — get_pit_recharge_rectangular","text":"height vertical height (depth) pit length horizontal length pit width horizontal width pit theta_s Soil porosity Ksat Saturated hydraulic conductivity theta_0 Soil volumetric water content prior event h_0 Hydraulic head soil prior event times Times calculate total infiltration","code":""},{"path":"/reference/get_pit_recharge_rectangular.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Rectangular pit flow — get_pit_recharge_rectangular","text":"function calculates infiltration rectangular pit, using assumptions Green Ampt equation. infiltration sum following horizontal infiltration * (width + length) * 2 vertical infiltration * width * length function assumed pit full duration infiltration experiment, meaning surface pressure head zero bottom pressure head length.","code":""},{"path":"/reference/get_pit_recharge_rectangular.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Rectangular pit flow — get_pit_recharge_rectangular","text":"","code":"library(units) theta_0 <- 0.2 # unitless theta_s <- 0.35 # unitless Ksat <- set_units(0.2, \"cm/h\") # length / time h_0 <- set_units(-10, \"cm\") # hydraulic head (length) times <- set_units(1,\"hr\") length <- set_units(4, \"ft\") width <- set_units(4, \"ft\") height <- set_units(6, \"ft\")"},{"path":"/reference/get_rawls_soil.html","id":null,"dir":"Reference","previous_headings":"","what":"Get rawls soil params — get_rawls_soil","title":"Get rawls soil params — get_rawls_soil","text":"Get rawls soil params","code":""},{"path":"/reference/get_rawls_soil.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get rawls soil params — get_rawls_soil","text":"","code":"get_rawls_soil(soil_name)"},{"path":"/reference/get_rawls_soil.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get rawls soil params — get_rawls_soil","text":"soil_name soil name matching rawls_soils$texture_class","code":""},{"path":"/reference/get_rawls_soil.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Get rawls soil params — get_rawls_soil","text":"Returns soil properties Rawls et al (1982)","code":""},{"path":"/reference/get_rawls_soil.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get rawls soil params — get_rawls_soil","text":"","code":"print(rawls_soils$texture_class) #>  [1] \"Sand\"            \"Loamy sand\"      \"Sandy loam\"      \"Loam\"            #>  [5] \"Silt loam\"       \"Sandy clay loam\" \"Clay loam\"       \"Silty clay loam\" #>  [9] \"Sandy clay\"      \"Silty clay\"      \"Clay\"            sand_rawls <- get_rawls_soil(soil_name = \"Sandy loam\") get_rawls_soil(soil_name = c(\"Sand\",\"Sandy loam\")) #> # A tibble: 2 × 10 #>   texture_class sample_size porosity theta_r porosity_effective #>   <chr>               <dbl>    <dbl>   <dbl>              <dbl> #> 1 Sand                  762    0.437   0.02               0.417 #> 2 Sandy loam            666    0.453   0.041              0.412 #> # ℹ 5 more variables: bubbling_pressure_arithmetic_cm <dbl>, #> #   bubbling_pressure_geometric_cm <dbl>, pore_size_distrib_arithmetic <dbl>, #> #   pore_size_distrib_geometric <dbl>, Ksat_cm_per_h <dbl>"},{"path":"/reference/get_vg_hydraulic_head.html","id":null,"dir":"Reference","previous_headings":"","what":"van Genuchten Water Retention Curve — get_vg_hydraulic_head","title":"van Genuchten Water Retention Curve — get_vg_hydraulic_head","text":"van Genuchten Water Retention Curve","code":""},{"path":"/reference/get_vg_hydraulic_head.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"van Genuchten Water Retention Curve — get_vg_hydraulic_head","text":"","code":"get_vg_hydraulic_head(theta, theta_r, theta_s, alpha, gamma_s)"},{"path":"/reference/get_vg_hydraulic_head.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"van Genuchten Water Retention Curve — get_vg_hydraulic_head","text":"theta volumetric water content theta_r residual water content theta_s saturated water content alpha scaling parameter (reciprocal air entry pressure, units 1/length) gamma_s curve shape, dimensionless","code":""},{"path":"/reference/get_vg_hydraulic_head.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"van Genuchten Water Retention Curve — get_vg_hydraulic_head","text":"See: Pan, T., Hou, S., Liu, Y., & Tan, Q. (2019). Comparison three models fitting soil water retention curves degraded alpine meadow region. Scientific Reports, 9(1), 18407.","code":""},{"path":"/reference/get_vg_hydraulic_head.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"van Genuchten Water Retention Curve — get_vg_hydraulic_head","text":"","code":"# example code library(units) theta <- 0.24 theta_r <- 0.15 theta_s <- 0.25 alpha <- set_units(0.008, \"1/cm\") # should have units of 1/length gamma_s <- 10.4 get_vg_hydraulic_head(theta, theta_r, theta_s, alpha, gamma_s) #> -102.2389 [cm]"},{"path":"/reference/pipe.html","id":null,"dir":"Reference","previous_headings":"","what":"Pipe operator — %>%","title":"Pipe operator — %>%","text":"See magrittr::%>% details.","code":""},{"path":"/reference/pipe.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Pipe operator — %>%","text":"","code":"lhs %>% rhs"},{"path":"/reference/pipe.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Pipe operator — %>%","text":"lhs value magrittr placeholder. rhs function call using magrittr semantics.","code":""},{"path":"/reference/pipe.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Pipe operator — %>%","text":"result calling `rhs(lhs)`.","code":""},{"path":"/reference/rawls_soils.html","id":null,"dir":"Reference","previous_headings":"","what":"Rawls soil data — rawls_soils","title":"Rawls soil data — rawls_soils","text":"Rawls soil data","code":""},{"path":"/reference/rawls_soils.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Rawls soil data — rawls_soils","text":"","code":"rawls_soils"},{"path":"/reference/rawls_soils.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Rawls soil data — rawls_soils","text":"object class tbl_df (inherits tbl, data.frame) 11 rows 10 columns.","code":""},{"path":"/reference/rawls_soils.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Rawls soil data — rawls_soils","text":"Soil properties Rawls et al (1982) Rawls, W. J., Brakensiek, D. L., & Saxtonn, K. E. (1982). Estimation Soil Water Properties. Transactions ASAE. https://doi.org/10.13031/2013.33720","code":""}]
