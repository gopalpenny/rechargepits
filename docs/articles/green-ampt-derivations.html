<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="rechargepits">
<title>green-ampt-derivations • rechargepits</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="green-ampt-derivations">
<meta property="og:description" content="rechargepits">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">rechargepits</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/green-ampt-derivations.html">green-ampt-derivations</a>
    <a class="dropdown-item" href="../articles/recharge-pit-models.html">recharge-pit-models</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>green-ampt-derivations</h1>
            
      
      
      <div class="d-none name"><code>green-ampt-derivations.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">rechargepits</span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="green-ampt-derivations">Green-ampt derivations<a class="anchor" aria-label="anchor" href="#green-ampt-derivations"></a>
</h2>
<p>This packages provides analytical and root-finding methods for
calculating groundwater recharge under specific geometries. In each
case, the models follow assumptions used in the Green-Ampt method:</p>
<ol style="list-style-type: decimal">
<li>Homogeneous soil with initial water content (theta_0)</li>
<li>Constant pressure head (h_0) at the wetting front</li>
<li>Saturated soil above above wetting front</li>
<li>Continuous supply of water with constant head (h_b) at the soil
surface boundary</li>
</ol>
<p>The building blocks of the pit recharge calculations are analytical
equations simulating the specific infiltration scenarios described
below.</p>
<div class="section level3">
<h3 id="vertical-flow-green-ampt-equation">Vertical flow: Green-Ampt equation<a class="anchor" aria-label="anchor" href="#vertical-flow-green-ampt-equation"></a>
</h3>
<p><img src="green-ampt-vertical.jpg" width="200px"></p>
<p>To derive the Green-Ampt equation, we need to combine the following
equations. First, Darcy flow:</p>
<p><span class="math display">\[
q = -K_{sat} \frac{\partial h}{\partial z}
\]</span> Where <span class="math inline">\(q\)</span> is the downward
Darcy point flow, <span class="math inline">\(h\)</span> is hydraulic
head as the sum of pressure and elevation head, <span class="math inline">\(K_{sat}\)</span> is saturated hydraulic
conductivity, and <span class="math inline">\(z\)</span> is elevation
(positive is downward). Note that the total head at the bottom of the
pit (<span class="math inline">\(z=0\)</span>) is <span class="math inline">\(h_b\)</span> and at the wetting front (<span class="math inline">\(z=z_f\)</span>) is <span class="math inline">\(h_0
- z_f\)</span>. Due to the linear relationship between <span class="math inline">\(h\)</span> and <span class="math inline">\(z\)</span>, integrating this equation allows us to
calculate <span class="math inline">\(q\)</span> as:</p>
<p><span class="math display">\[
q = K_{sat} \frac{h_b - (h_0 - z_f)}{z_f}
\]</span></p>
<p>We also know that the downward propagation of the wetting front
occurs at the rate</p>
<p><span class="math display">\[\frac{\partial z_f}{\partial t} =
\frac{q}{\Delta \theta},\]</span></p>
<p>where <span class="math inline">\(\Delta \theta = \theta_s -
\theta_0\)</span>. We further know that the cumulative infiltration is
<span class="math inline">\(F = z_f \Delta \theta\)</span>, and
combining the above equations with this substitution yields:</p>
<p><span class="math display">\[
\frac{F}{\Delta \theta} \frac{\partial F}{\partial t} = K_{sat} (h_b +
F/\Delta \theta - h_0)
\]</span></p>
<p>Integration of the above equation yields the Green-Ampt equation,
with time <span class="math inline">\(t\)</span> as a function of
cumulative 1-D infiltration <span class="math inline">\(F\)</span>:</p>
<p><span class="math display">\[
t = \frac{1}{K_{sat}}\Big[F - \Delta \theta (h_b - h_0) \ln (1 +
\frac{F}{\Delta \theta (h_b - h_0)}) \Big]
\]</span></p>
<p>The Green-Ampt equation is implemented in this package through the
function <code>get_greenampt_time</code> which implements the analytical
version, as well as the function
<code>get_greenampt_flow_numerical</code> which uses a root solver to
find cumulative infiltration as a function of time. Note that the
package functions expects <code>units</code> objects where appropriate
to ensure proper arithmetic with dimensional variables. Below, the
numerical approximation calculates <span class="math inline">\(F\)</span> at <span class="math inline">\(t \in
[0, 2, 5, 10, 20, 40, 60]\)</span> minutes.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># prep soil variables</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">rechargepits</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-quantities.github.io/units/" class="external-link">units</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; udunits database from /Library/Frameworks/R.framework/Versions/4.3-arm64/Resources/library/units/share/udunits/udunits2.xml</span></span>
<span><span class="va">theta_0</span> <span class="op">&lt;-</span> <span class="fl">0.2</span> <span class="co"># unitless</span></span>
<span><span class="va">theta_s</span> <span class="op">&lt;-</span> <span class="fl">0.35</span> <span class="co"># unitless</span></span>
<span><span class="va">Ksat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-quantities.github.io/units/reference/units.html" class="external-link">set_units</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="st">"cm/h"</span><span class="op">)</span> <span class="co"># length / time</span></span>
<span><span class="va">h_b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-quantities.github.io/units/reference/units.html" class="external-link">set_units</a></span><span class="op">(</span><span class="fl">6</span>, <span class="st">"ft"</span><span class="op">)</span> <span class="co"># hydraulic head (length)</span></span>
<span><span class="va">h_0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-quantities.github.io/units/reference/units.html" class="external-link">set_units</a></span><span class="op">(</span><span class="op">-</span><span class="fl">10</span>, <span class="st">"cm"</span><span class="op">)</span> <span class="co"># hydraulic head (length)</span></span>
<span><span class="va">times</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-quantities.github.io/units/reference/units.html" class="external-link">set_units</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2</span>, <span class="fl">5</span>, <span class="fl">10</span>, <span class="fl">20</span>, <span class="fl">40</span>, <span class="fl">60</span><span class="op">)</span>, <span class="st">"min"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate cumulative infiltration as a function of time</span></span>
<span><span class="va">Fcum</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_greenampt_flow_numerical.html">get_greenampt_flow_numerical</a></span><span class="op">(</span><span class="va">theta_0</span>, <span class="va">theta_s</span>, <span class="va">Ksat</span>, <span class="va">h_b</span>, <span class="va">h_0</span>, <span class="va">times</span><span class="op">)</span></span>
<span><span class="va">Fcum</span></span>
<span><span class="co">#&gt; Units: [mm]</span></span>
<span><span class="co">#&gt; [1]  0.000000  6.255460  9.931811 14.111226 20.087695 28.672159 35.365012</span></span></code></pre></div>
<p>Note that the returned vector is a <code>units</code> object, in this
case with units of mm. We can make sure the two functions produce the
same results by using the analytical version to convert back to time as
follows, and plot the results.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Calculate time as a function of Fcum </span></span>
<span><span class="va">time_calc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-quantities.github.io/units/reference/units.html" class="external-link">set_units</a></span><span class="op">(</span><span class="fu"><a href="../reference/get_greenampt_time.html">get_greenampt_time</a></span><span class="op">(</span><span class="va">theta_0</span>, <span class="va">theta_s</span>, <span class="va">Fcum</span>, <span class="va">Ksat</span>, <span class="va">h_b</span>, <span class="va">h_0</span><span class="op">)</span>,<span class="st">"min"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">times</span>, <span class="va">time_calc</span><span class="op">)</span>,</span>
<span>                 Fcum <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">Fcum</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>                 group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Fcum = f(t)"</span>, <span class="st">"t = f(Fcum)"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">Fcum</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">Fcum</span>, color <span class="op">=</span> <span class="va">group</span>, shape <span class="op">=</span> <span class="va">group</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">3</span>, stroke <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_shape_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="green-ampt-derivations_files/figure-html/unnamed-chunk-4-1.png" width="576"></p>
</div>
<div class="section level3">
<h3 id="horizontal-flow-green-ampt-without-gravity">Horizontal flow: Green-Ampt without gravity<a class="anchor" aria-label="anchor" href="#horizontal-flow-green-ampt-without-gravity"></a>
</h3>
<div class="section level4">
<h4 id="horizontal-parallel-flow">Horizontal parallel flow<a class="anchor" aria-label="anchor" href="#horizontal-parallel-flow"></a>
</h4>
<p><img src="green-ampt-horizontal.jpg" width="150px"></p>
<p>This scenario is similar to Green-Ampt except that the flow occurs
horizontally through a vertical surface. Darcy flow in this case can be
calculated as: <span class="math display">\[
q = K_{sat} \frac{h_b - h_0}{x_f},
\]</span> where the only new variable is <span class="math inline">\(x_f\)</span>, the horizontal distance from the
soil boundary to the wetting front. Note that cumulative infiltration is
<span class="math inline">\(F = x_f \Delta \theta\)</span>. Also note
that <span class="math inline">\(x_f\)</span> is not present in the
numerator. This equation becomes:</p>
<p><span class="math display">\[
\frac{F}{\Delta \theta} \frac{\partial F}{\partial t} = K_{sat} (h_b -
h_0).
\]</span></p>
<p>Once integrated, we get two versions of the final equations, one
solved for <span class="math inline">\(t\)</span>: <span class="math display">\[
t = \frac{F^2}{2 \Delta \theta K_{sat} (h_b - h_0)}
\]</span> and the other for <span class="math inline">\(F\)</span>:
<span class="math display">\[
F = \sqrt{2 \Delta \theta K_{sat} (h_b - h_0) t},
\]</span></p>
<p>Using the same soil properties as above, we can calculate
infiltration using <code>get_greenampt_horiz_flow</code> and
<code>get_greenampt_horiz_time</code>:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Calculate cumulative infiltration as a function of time</span></span>
<span><span class="va">Fcum_horiz</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_greenampt_horiz_flow.html">get_greenampt_horiz_flow</a></span><span class="op">(</span><span class="va">theta_0</span>, <span class="va">theta_s</span>, <span class="va">Ksat</span>, <span class="va">h_b</span>, <span class="va">h_0</span>, <span class="va">times</span><span class="op">)</span></span>
<span><span class="va">Fcum_horiz</span></span>
<span><span class="co">#&gt; Units: [cm]</span></span>
<span><span class="co">#&gt; [1] 0.0000000 0.6210958 0.9820387 1.3888124 1.9640774 2.7776249 3.4018818</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">time_calc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-quantities.github.io/units/reference/units.html" class="external-link">set_units</a></span><span class="op">(</span><span class="fu"><a href="../reference/get_greenampt_horiz_time.html">get_greenampt_horiz_time</a></span><span class="op">(</span><span class="va">theta_0</span>, <span class="va">theta_s</span>, <span class="va">Fcum_horiz</span>, <span class="va">Ksat</span>, <span class="va">h_b</span>, <span class="va">h_0</span><span class="op">)</span>,<span class="st">"min"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">times</span>, <span class="va">time_calc</span><span class="op">)</span>,</span>
<span>                 Fcum <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">Fcum</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>                 group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Fcum = f(t)"</span>, <span class="st">"t = f(Fcum)"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">Fcum</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">Fcum</span>, color <span class="op">=</span> <span class="va">group</span>, shape <span class="op">=</span> <span class="va">group</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">3</span>, stroke <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_shape_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="green-ampt-derivations_files/figure-html/unnamed-chunk-7-1.png" width="576"></p>
</div>
<div class="section level4">
<h4 id="horizontal-parallel-flow-integrated-over-a-depth">Horizontal parallel flow integrated over a depth<a class="anchor" aria-label="anchor" href="#horizontal-parallel-flow-integrated-over-a-depth"></a>
</h4>
<p><img src="green-ampt-horizontal-integrated.jpg" width="150px"></p>
<p>Now we’d like to have a single equation to calculate the horizontal
infiltration over a vertical surface, which we refer to as <span class="math inline">\(F_v\)</span>, while noting that <span class="math inline">\(\Delta F_v = F \Delta z\)</span>. Therefore we
need to integrate, noting that we now use <span class="math inline">\(h_p(z)\)</span> to indicate the pressure head in
the pit:</p>
<p><span class="math display">\[
F_v = \int F \partial z = \sqrt{2 \Delta \theta K_{sat} t}
\int_{z_1}^{z_1 + d} (h_p(z) - h_0)^{1/2} \partial z
\]</span></p>
<p>where <span class="math inline">\(d\)</span> is the depth of the
profile over which to integrate (e.g., the bottom of the pit). If we
define <span class="math inline">\(z\)</span> as being positive in the
downward direction then <span class="math inline">\(h_p = z\)</span>. We
define <span class="math inline">\(h_b\)</span> as the pressure head at
the bottom of the profile, which entails that <span class="math inline">\(z_2 = h_b\)</span> and <span class="math inline">\(z_1 = h_b - d\)</span> at the top of the pit. The
integration becomes:</p>
<p><span class="math display">\[
F_v = \sqrt{2 \Delta \theta K_{sat} t} \int_{h_b - d}^{h_b} (z -
h_0)^{1/2} \partial z
\]</span> Integrating the right side we end up with: <span class="math display">\[
F_v = \sqrt{\frac{8}{9} \Delta \theta K_{sat} t} \Big[(h_b - h_0)^{3/2}
- (h_b - d - h_0)^{3/2} \Big]
\]</span></p>
<p>This equation is implemented with
<code>get_greenampt_horiz_flow_integrated</code>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-quantities.github.io/units/" class="external-link">units</a></span><span class="op">)</span></span>
<span><span class="va">theta_0</span> <span class="op">&lt;-</span> <span class="fl">0.2</span> <span class="co"># unitless</span></span>
<span><span class="va">theta_s</span> <span class="op">&lt;-</span> <span class="fl">0.35</span> <span class="co"># unitless</span></span>
<span><span class="va">Ksat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-quantities.github.io/units/reference/units.html" class="external-link">set_units</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="st">"cm/h"</span><span class="op">)</span> <span class="co"># length / time</span></span>
<span><span class="va">h_b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-quantities.github.io/units/reference/units.html" class="external-link">set_units</a></span><span class="op">(</span><span class="fl">6</span>, <span class="st">"ft"</span><span class="op">)</span> <span class="co"># hydraulic head (length)</span></span>
<span><span class="va">h_0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-quantities.github.io/units/reference/units.html" class="external-link">set_units</a></span><span class="op">(</span><span class="op">-</span><span class="fl">10</span>, <span class="st">"cm"</span><span class="op">)</span> <span class="co"># hydraulic head (length)</span></span>
<span></span>
<span><span class="va">Fv</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_greenampt_horiz_flow_integrated.html">get_greenampt_horiz_flow_integrated</a></span><span class="op">(</span><span class="va">theta_0</span>, <span class="va">theta_s</span>, <span class="va">Ksat</span>, <span class="va">h_b</span>, <span class="va">h_0</span>, times <span class="op">=</span> <span class="fu"><a href="https://r-quantities.github.io/units/reference/units.html" class="external-link">set_units</a></span><span class="op">(</span><span class="fl">1</span>,<span class="st">"hr"</span><span class="op">)</span>, d <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
<p>To demonstrate this works, we can compare the point flow with the
integrated flow over a differential depth (e.g., 1 mm):</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get the infiltration over a 1 mm differential depth to compare with the point infiltration</span></span>
<span><span class="va">Fv_dv</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_greenampt_horiz_flow_integrated.html">get_greenampt_horiz_flow_integrated</a></span><span class="op">(</span><span class="va">theta_0</span>, <span class="va">theta_s</span>, <span class="va">Ksat</span>, <span class="va">h_b</span>, <span class="va">h_0</span>, times <span class="op">=</span> <span class="fu"><a href="https://r-quantities.github.io/units/reference/units.html" class="external-link">set_units</a></span><span class="op">(</span><span class="fl">1</span>,<span class="st">"hr"</span><span class="op">)</span>, d <span class="op">=</span> <span class="fu"><a href="https://r-quantities.github.io/units/reference/units.html" class="external-link">set_units</a></span><span class="op">(</span><span class="fl">1</span>, <span class="st">"mm"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">Fv_point</span> <span class="op">&lt;-</span> <span class="va">Fv_dv</span><span class="op">/</span> <span class="fu"><a href="https://r-quantities.github.io/units/reference/units.html" class="external-link">set_units</a></span><span class="op">(</span><span class="fl">1</span>, <span class="st">"mm"</span><span class="op">)</span></span>
<span><span class="va">Fv_point</span></span>
<span><span class="co">#&gt; 34.01441 [mm]</span></span>
<span></span>
<span><span class="co"># Get the point infiltration</span></span>
<span><span class="va">F_point</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_greenampt_horiz_flow.html">get_greenampt_horiz_flow</a></span><span class="op">(</span><span class="va">theta_0</span>, <span class="va">theta_s</span>, <span class="va">Ksat</span>, <span class="va">h_b</span>, <span class="va">h_0</span>, times <span class="op">=</span> <span class="fu"><a href="https://r-quantities.github.io/units/reference/units.html" class="external-link">set_units</a></span><span class="op">(</span><span class="fl">1</span>,<span class="st">"hr"</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="va">F_point</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-quantities.github.io/units/reference/units.html" class="external-link">set_units</a></span><span class="op">(</span><span class="va">F_point</span>, <span class="st">"mm"</span><span class="op">)</span></span>
<span><span class="va">F_point</span></span>
<span><span class="co">#&gt; 34.01882 [mm]</span></span>
<span><span class="co"># percent error: (Fv_point - F_point) / F_point * 100</span></span></code></pre></div>
<p>The percent error is -0.013%.</p>
<p>This final example shows how the shape of the wetting front along the
profile is curved.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">VWC_0</span> <span class="op">&lt;-</span> <span class="fl">0.2</span> <span class="co"># unitless</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">0.35</span> <span class="co"># unitless</span></span>
<span><span class="va">Ksat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-quantities.github.io/units/reference/units.html" class="external-link">set_units</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="st">"cm/h"</span><span class="op">)</span> <span class="co"># length / time</span></span>
<span><span class="va">h_b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-quantities.github.io/units/reference/units.html" class="external-link">set_units</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">6</span><span class="op">)</span>, <span class="st">"ft"</span><span class="op">)</span> <span class="co"># hydraulic head (length)</span></span>
<span><span class="va">h_0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-quantities.github.io/units/reference/units.html" class="external-link">set_units</a></span><span class="op">(</span><span class="op">-</span><span class="fl">10</span>, <span class="st">"cm"</span><span class="op">)</span> <span class="co"># hydraulic head (length)</span></span>
<span><span class="va">times</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-quantities.github.io/units/reference/units.html" class="external-link">set_units</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">60</span><span class="op">)</span>, <span class="st">"min"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate cumulative infiltration as a function of time</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">h_b</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">h_b_z</span> <span class="op">&lt;-</span> <span class="va">h_b</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">i</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">Fcum</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_greenampt_flow_numerical.html">get_greenampt_flow_numerical</a></span><span class="op">(</span><span class="va">VWC_0</span>, <span class="va">n</span>, <span class="va">Ksat</span>, <span class="va">h_b_z</span>, <span class="va">h_0</span>, <span class="va">times</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="va">Fcum</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_greenampt_flow_numerical.html">get_greenampt_flow_numerical</a></span><span class="op">(</span><span class="va">VWC_0</span>, <span class="va">n</span>, <span class="va">Ksat</span>, <span class="va">h_b_z</span>, <span class="va">h_0</span>, <span class="va">times</span><span class="op">)</span></span>
<span> </span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">Fcum</span>, <span class="op">-</span><span class="va">h_b</span><span class="op">)</span></span></code></pre></div>
<p><img src="green-ampt-derivations_files/figure-html/unnamed-chunk-11-1.png" width="576"></p>
</div>
<div class="section level4">
<h4 id="horizontal-flow-through-a-cylinder">Horizontal flow through a cylinder<a class="anchor" aria-label="anchor" href="#horizontal-flow-through-a-cylinder"></a>
</h4>
<p><img src="green-ampt-circular.jpg" width="200px"></p>
<p>We now focus on horizontal flow (i.e., no gravity effect) radially
outward through cylinder. In this case the goal is to calculate the
radius of the wetting front (<span class="math inline">\(r_f\)</span>),
from which the cumulative infiltration can be calculated at any time
<span class="math inline">\(t\)</span> as <span class="math inline">\(F_c = \pi (r_f^2 - r_b^2) \Delta \theta\)</span>,
where <span class="math inline">\(r_b\)</span> is the boundary of the
recharge pit.</p>
<p>We note that <span class="math inline">\(Q = 2 \pi r q(r)\)</span>
and therefore <span class="math inline">\(q = \frac{Q}{2 \pi
r}\)</span>. Because <span class="math inline">\(q\)</span> is the Darcy
flow, we can plug this into Darcy’s law to obtain: <span class="math display">\[
\frac{Q}{2 \pi r} = -K_{sat} \frac{\partial h}{\partial r}
\]</span> Integrating this equation from <span class="math inline">\((r_b, h_b)\)</span> to <span class="math inline">\((r_f, h_0)\)</span>, we get: <span class="math display">\[
Q = 2 \pi K_{sat} (h_b - h_0) \frac{1}{\ln (r_f / r_b)}
\]</span></p>
<p>We further note that the propagation of the wetting front outward is
directly related to <span class="math inline">\(Q\)</span> as <span class="math inline">\(\frac{\partial r_f}{\partial t} = \frac{Q}{2 \pi
r_f \Delta \theta}\)</span>. Plugging in the equation for <span class="math inline">\(Q\)</span> and rearranging, we obtain: <span class="math display">\[
r_f \ln(r_f / r_b) \partial r_f = \frac{1}{\Delta \theta }(h_b - h_0)
\partial t
\]</span> Integrating the two sides from <span class="math inline">\((t
= 0, r = r_b)\)</span> to <span class="math inline">\((t, r_f)\)</span>,
we obtain (via wolfram alpha): <span class="math display">\[
\frac{1}{4} (r_b^2 + 2 r_f^2 \ln \frac{r_f}{r_b} - r_f^2) = t\frac{h_b -
h_0}{\Delta \theta }
\]</span> Finally, solving for <span class="math inline">\(t\)</span>,
we obtain: <span class="math display">\[
t = \frac{\Delta \theta}{4 (h_b - h_0)} (r_b^2 + 2 r_f^2 \ln
\frac{r_f}{r_b} - r_f^2)
\]</span> <span class="math display">\[
t = \frac{\Delta \theta}{4 (h_b - h_0)} \Big[r_b^2 + r_f^2 (2  \ln
\frac{r_f}{r_b} - 1) \Big]
\]</span> As noted above, it is straightforward to convert between <span class="math inline">\(F_c\)</span> and <span class="math inline">\(r_f\)</span>. Rearranging the prior equation, we
have: <span class="math display">\[
r_f = \sqrt{ \frac{F_c}{\pi \Delta \theta} + r_b^2}
\]</span></p>
<p>This model is implemented using the functions
<code>get_greenampt_cyl_horiz_time</code> to calculate time as <span class="math inline">\(t = f(F_c)\)</span> and
<code>get_greenampt_cyl_horiz_numerical</code> to calculate cumulative
recharge <span class="math inline">\(F_c = f(t)\)</span> using a
numerical solver.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-quantities.github.io/units/" class="external-link">units</a></span><span class="op">)</span></span>
<span><span class="va">r_b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-quantities.github.io/units/reference/units.html" class="external-link">set_units</a></span><span class="op">(</span><span class="fl">2</span>, <span class="st">"ft"</span><span class="op">)</span> <span class="co"># length</span></span>
<span><span class="va">theta_0</span> <span class="op">&lt;-</span> <span class="fl">0.2</span> <span class="co"># unitless</span></span>
<span><span class="va">theta_s</span> <span class="op">&lt;-</span> <span class="fl">0.35</span> <span class="co"># unitless</span></span>
<span><span class="va">F_c</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-quantities.github.io/units/reference/units.html" class="external-link">set_units</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">5</span>, <span class="fl">10</span>, <span class="fl">20</span><span class="op">)</span>, <span class="st">"ft^2"</span><span class="op">)</span> <span class="co"># units of length^2</span></span>
<span><span class="va">Ksat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-quantities.github.io/units/reference/units.html" class="external-link">set_units</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="st">"cm/h"</span><span class="op">)</span> <span class="co"># length / time</span></span>
<span><span class="va">h_b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-quantities.github.io/units/reference/units.html" class="external-link">set_units</a></span><span class="op">(</span><span class="fl">6</span>, <span class="st">"ft"</span><span class="op">)</span> <span class="co"># hydraulic head (length)</span></span>
<span><span class="va">h_0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-quantities.github.io/units/reference/units.html" class="external-link">set_units</a></span><span class="op">(</span><span class="op">-</span><span class="fl">10</span>, <span class="st">"cm"</span><span class="op">)</span> <span class="co"># hydraulic head (length)</span></span>
<span><span class="va">times</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_greenampt_cyl_horiz_time.html">get_greenampt_cyl_horiz_time</a></span><span class="op">(</span><span class="va">theta_0</span>, <span class="va">theta_s</span>, <span class="va">F_c</span>, <span class="va">Ksat</span>, <span class="va">h_b</span>, <span class="va">h_0</span>, <span class="va">r_b</span><span class="op">)</span></span>
<span><span class="va">F_c_calculated</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_greenampt_cyl_horiz_numerical.html">get_greenampt_cyl_horiz_numerical</a></span><span class="op">(</span><span class="va">theta_0</span>, <span class="va">theta_s</span>, <span class="va">Ksat</span>, <span class="va">h_b</span>, <span class="va">h_0</span>, <span class="va">r_b</span>, <span class="va">times</span>, F_units <span class="op">=</span> <span class="st">"ft^2"</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">times</span>, <span class="va">F_c</span>, cex <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="st">'blue'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">times</span>, <span class="va">F_c_calculated</span>, pch <span class="op">=</span> <span class="fl">4</span>, col <span class="op">=</span> <span class="st">'red'</span>, cex <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">7</span>, legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"get_greenampt_hsphere_time"</span>, <span class="st">"get_greenampt_hsphere_numerical"</span><span class="op">)</span>, </span>
<span>       col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"blue"</span>, <span class="st">"red"</span><span class="op">)</span>, cex <span class="op">=</span> <span class="fl">0.8</span>, pch <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="green-ampt-derivations_files/figure-html/unnamed-chunk-13-1.png" width="576"></p>
</div>
</div>
<div class="section level3">
<h3 id="half-spherical-flow-without-gravity">Half-spherical flow without gravity<a class="anchor" aria-label="anchor" href="#half-spherical-flow-without-gravity"></a>
</h3>
<p><img src="green-ampt-half-spherical.jpg" width="200px"></p>
<p>In this case we consider flow through a half spherical surface
considering only pressure potentials and ignoring gravity. This model
could potentially approximate 3-D infiltration through the bottom of a
recharge pit in which the pressure head at the bottom of the pit large
enough such that the gravity term is small. The approach to the
derivation is similar to cylindrical flow, in that we first need to
understand the hydraulic gradient as a function of <span class="math inline">\(r_f\)</span>, the radius to the wetting front. The
surface area through which flow passes is <span class="math inline">\(2
\pi r^2\)</span>, which is half the surface area of a sphere (<span class="math inline">\(4 \pi r^2\)</span>). Because only pressure matters
and flow is the same throughout the half-sphere, we can write Darcy’s
law as: <span class="math display">\[
\frac{Q}{2 \pi r^2} = -K_{sat} \frac{\partial h}{\partial r}.
\]</span></p>
<p>We approximate the bottom of the pit as a half sphere with radius
<span class="math inline">\(r_b\)</span>, the effective radius of the
pit. Although a simplification of reality, it makes the scenario
mathematically tractable. We integrate the above equation from the
idealized pit boundary <span class="math inline">\((r_b, h_b)\)</span>
to the wetting front <span class="math inline">\((r_f, h_0)\)</span> and
obtain: <span class="math display">\[
\frac{Q}{2 \pi}\Big(\frac{1}{r_b} - \frac{1}{r_f}\Big) = K_{sat} (h_b -
h_0)
\]</span> Solving for <span class="math inline">\(Q\)</span>, we obtain:
<span class="math display">\[
Q = 2 \pi K_{sat} \Big(\frac{r_b r_f}{r_f - r_b} \Big) (h_b - h_0)
\]</span></p>
<p>Now that we have <span class="math inline">\(Q\)</span> as a function
of <span class="math inline">\(r_f\)</span>, we can focus on determining
how <span class="math inline">\(r_f\)</span> changes over time. The
propagation of <span class="math inline">\(r_f\)</span> is simply the
total outward flow <span class="math inline">\(Q\)</span> divided by the
surface area of the half sphere <span class="math inline">\(2 \pi
r^2\)</span>, divided by the available soil storage <span class="math inline">\(\Delta \theta = \theta_s - \theta_0\)</span>. In
other words: <span class="math display">\[
\frac{\partial r_f}{\partial t} = \frac{Q}{2 \pi r^2 \Delta \theta} \, .
\]</span> Plugging in for <span class="math inline">\(Q\)</span> and
rearranging terms, we get: <span class="math display">\[
\frac{1}{r_b} \Big[ r_f^2 - r_b r_f \Big] \partial r_f =
\frac{K_{sat}}{\Delta \theta} \Big[ h_b - h_0 \Big] \partial t \,.
\]</span></p>
<p>We can then integrate from <span class="math inline">\((r_b,
0)\)</span> to <span class="math inline">\((r_f, t)\)</span> to obtain:
<span class="math display">\[
\frac{1}{r_b} \Big( \frac{1}{3} r_f^3 - \frac{r_b}{2} r_f^2 \Big)
\Bigg|_{r_b}^{r_f} = \frac{K_{sat}}{\Delta \theta} \Big( h_b - h_0 \Big)
t \, \Bigg|_0^t
\]</span></p>
<p>Plugging in values and solving for <span class="math inline">\(t\)</span>, we finally obtain: <span class="math display">\[
t = \frac{\Delta \theta}{K_{sat} (h_b - h_0)}  \Bigg[ \frac{r_f^3}{3
r_b}  - \frac{r_f^2}{2} + \frac{r_b^2}{6} \Bigg]
\]</span></p>
<p>The volume of a half sphere is equal to <span class="math inline">\(V_s(r) = 2/3 \pi r^3\)</span>. Therefore we can
determine the amount of infiltration as <span class="math inline">\(F_s
= \Delta \theta (V_s(r_f) - V_s(r_b))\)</span>, or: <span class="math display">\[
F_s = \Delta \theta \pi \frac{2}{3}\Big( r_f^3 - r_b^3 \Big)
\]</span> Conversely, we can calculate <span class="math inline">\(r_f\)</span> from <span class="math inline">\(F_s\)</span> as: <span class="math display">\[
r_f = \Big( \frac{3 F_s}{2 \Delta \theta \pi} + r_b^3 \Big)^{1/3}
\]</span></p>
<p>This model is implemented using the functions
<code>get_greenampt_hsphere_time</code> to calculate time as <span class="math inline">\(t = f(F_s)\)</span> and
<code>get_greenampt_hsphere_numerical</code> to calculate cumulative
recharge <span class="math inline">\(F_s = f(t)\)</span> using a
numerical solver.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-quantities.github.io/units/" class="external-link">units</a></span><span class="op">)</span></span>
<span><span class="va">r_b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-quantities.github.io/units/reference/units.html" class="external-link">set_units</a></span><span class="op">(</span><span class="fl">2</span>, <span class="st">"ft"</span><span class="op">)</span> <span class="co"># length</span></span>
<span><span class="va">theta_0</span> <span class="op">&lt;-</span> <span class="fl">0.2</span> <span class="co"># unitless</span></span>
<span><span class="va">theta_s</span> <span class="op">&lt;-</span> <span class="fl">0.35</span> <span class="co"># unitless</span></span>
<span><span class="va">F_s</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-quantities.github.io/units/reference/units.html" class="external-link">set_units</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">5</span>, <span class="fl">10</span>, <span class="fl">20</span><span class="op">)</span>, <span class="st">"ft^3"</span><span class="op">)</span> <span class="co"># units of length^2</span></span>
<span><span class="va">Ksat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-quantities.github.io/units/reference/units.html" class="external-link">set_units</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="st">"cm/h"</span><span class="op">)</span> <span class="co"># length / time</span></span>
<span><span class="va">h_b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-quantities.github.io/units/reference/units.html" class="external-link">set_units</a></span><span class="op">(</span><span class="fl">6</span>, <span class="st">"ft"</span><span class="op">)</span> <span class="co"># hydraulic head (length)</span></span>
<span><span class="va">h_0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-quantities.github.io/units/reference/units.html" class="external-link">set_units</a></span><span class="op">(</span><span class="op">-</span><span class="fl">10</span>, <span class="st">"cm"</span><span class="op">)</span> <span class="co"># hydraulic head (length)</span></span>
<span><span class="va">times</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_greenampt_hsphere_time.html">get_greenampt_hsphere_time</a></span><span class="op">(</span><span class="va">theta_0</span>, <span class="va">theta_s</span>, <span class="va">F_s</span>, <span class="va">Ksat</span>, <span class="va">h_b</span>, <span class="va">h_0</span>, <span class="va">r_b</span><span class="op">)</span></span>
<span><span class="va">F_s_calculated</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_greenampt_hsphere_numerical.html">get_greenampt_hsphere_numerical</a></span><span class="op">(</span><span class="va">theta_0</span>, <span class="va">theta_s</span>, <span class="va">Ksat</span>, <span class="va">h_b</span>, <span class="va">h_0</span>, <span class="va">r_b</span>, <span class="va">times</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">times</span>, <span class="va">F_s</span>, cex <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="st">'blue'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">times</span>, <span class="va">F_s_calculated</span>, pch <span class="op">=</span> <span class="fl">4</span>, col <span class="op">=</span> <span class="st">'red'</span>, cex <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">7</span>, legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"get_greenampt_hsphere_time"</span>, <span class="st">"get_greenampt_hsphere_numerical"</span><span class="op">)</span>, </span>
<span>       col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"blue"</span>, <span class="st">"red"</span><span class="op">)</span>, cex <span class="op">=</span> <span class="fl">0.8</span>, pch <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="green-ampt-derivations_files/figure-html/unnamed-chunk-15-1.png" width="576"></p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by The package maintainer.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
